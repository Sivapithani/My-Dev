global with sharing class GamePlanForInvestmentsController 
{
    public Opportunity opp{get;set;}    
    public list<GamePlanResultsWrapper> results{get;set;}
    public list<GamePlanResultsWrapper> resultsTemp{get;set;}
    private transient map<id, Account> marketingRepAccMap;
    private transient map<id, Account> footerMarketingRepAccMap;
    private transient map<Id, ocm_FundFamily__c> fundNamesList {get;set;}
    public boolean displayPopup {get; set;}
    public static String sortBy {get;set;}
    public boolean sortAscending {get;set;}
    public string popupOrgId{get;set;}    
    public ocm_Event__c filterInputEvent {get;set;}
    public Integer total_size {get; set;}
    private Integer counter=0;
    private Integer list_size=100;
    public Account acc{get;set;}
    public ocm_FundFamily__c ff1 {get;set;}
    public ocm_FundFamily__c ff2 {get;set;}
    public ocm_FundFamily__c ff3 {get;set;}
    public ocm_FundFamily__c ff4 {get;set;}
    public ocm_FundFamily__c ff5 {get;set;}
    public ocm_FundFamily__c ff6 {get;set;}
    public ocm_FundFamily__c ff7 {get;set;}
    public ocm_FundFamily__c ff8 {get;set;}
    public ocm_FundFamily__c ff9 {get;set;}
    public ocm_FundFamily__c ff10 {get;set;}
    public ocm_FundFamily__c ff11 {get;set;}
    public ocm_FundFamily__c ff12 {get;set;}
    public ocm_FundFamily__c ff13 {get;set;}
    public ocm_FundFamily__c ff14 {get;set;}
    public ocm_FundFamily__c ff15 {get;set;}
    public ocm_FundFamily__c ff16 {get;set;}
    public ocm_FundFamily__c ff17 {get;set;}
    public ocm_FundFamily__c ff18 {get;set;}
    public ocm_FundFamily__c ff19 {get;set;}
    public ocm_FundFamily__c ff20 {get;set;}
    public ocm_FundFamily__c ff21 {get;set;}
    public ocm_FundFamily__c ff22 {get;set;}
    public ocm_FundFamily__c ff23 {get;set;}
    public ocm_FundFamily__c ff24 {get;set;}
    public ocm_FundFamily__c ff25 {get;set;}
    public ocm_FundFamily__c ff26 {get;set;}
    public ocm_FundFamily__c ff27 {get;set;}
    public ocm_FundFamily__c ff28 {get;set;}
    public ocm_FundFamily__c ff29 {get;set;}
    public ocm_FundFamily__c ff30 {get;set;}
    public ocm_FundFamily__c ff31 {get;set;}
    public ocm_FundFamily__c ff32 {get;set;}
    public ocm_FundFamily__c ff33 {get;set;}
    public ocm_FundFamily__c ff34 {get;set;}
    public ocm_FundFamily__c ff35 {get;set;}
    public ocm_FundFamily__c ff36 {get;set;}
    public ocm_FundFamily__c ff37 {get;set;}
    public ocm_FundFamily__c ff38 {get;set;}
    public ocm_FundFamily__c ff39 {get;set;}
    public ocm_FundFamily__c ff40 {get;set;}
    public ocm_FundFamily__c ff41 {get;set;}
    public ocm_FundFamily__c ff42 {get;set;}
    public ocm_FundFamily__c ff43 {get;set;}
    public ocm_FundFamily__c ff44 {get;set;}
    public ocm_FundFamily__c ff45 {get;set;}
    public ocm_FundFamily__c ff46 {get;set;}
    public ocm_FundFamily__c ff47 {get;set;}
    public ocm_FundFamily__c ff48 {get;set;}
    public ocm_FundFamily__c ff49 {get;set;}
    public ocm_FundFamily__c ff50 {get;set;}    
    private set<Id> fundIds;
    public string selectedAcc {get;set;}
    public string selectedActivityStatus {get;set;}
    private boolean isSaveClicked;    
    public transient String gamePlanOppRecId{get;set;}
    public list<orgResultsWrapper> popupResults{get;set;}    
    public transient string marketingRepName{get;set;}
    public string myOrgsId {get;set;}
    public string myTaggedOrgsId{get;set;}    
    public string myGamePlansId {get;set;}  
    public Integer popupOrgTotal 
    {
        get
        {
            return popUpTotal();
        }
        set;
    }
    
    public GamePlanResultsWrapper resultsTotal{get;set;}
    public string popupOrgName{get;set;}
    public GamePlanForInvestmentsController() 
    {        
        popupOrgTotal = 0;
        filterInputEvent = new ocm_Event__c();
        if(string.isEmpty(popupOrgId))
        {            
            acc = new Account();
            total_size = 0;
            selectedAcc = '';   
            selectedActivityStatus = '';
            opp = new Opportunity();
            isSaveClicked = false;
            if(system.now().month() <= 7)
                opp.Game_Plan_Year__c = string.valueOf(system.today().year());
            else
                opp.Game_Plan_Year__c = string.valueOf(system.today().year()+1);    
            resultsTotal = new GamePlanResultsWrapper();
            footerMarketingRepAccMap = new map<id, Account>();
            marketingRepAccMap = new map<id, Account>();

            acc.Primary_Marketing_Representative__c = UserInfo.getUserId();    
            list<Report> repIds = [Select r.Name, r.Id, r.DeveloperName From Report r where DeveloperName IN ('My_Organizations_for_Game_Plans',  'My_Tagged_Organizations_by_Strategy',  'My_2016_Game_Plan')];
            for(Report rep: repIds)
            {
                if(rep.DeveloperName == 'My_Organizations_for_Game_Plans')
                    myOrgsId = rep.Id;
                else if(rep.DeveloperName == 'My_Tagged_Organizations_by_Strategy')
                    myTaggedOrgsId = rep.Id;
                else if(rep.DeveloperName == 'My_2016_Game_Plan')
                    myGamePlansId = rep.Id; 
            }     
            loadData();        
        }    
    }
    
    private void loadData()
    {
        results = new list<GamePlanResultsWrapper>();
        //resultsTemp = new list<GamePlanResultsWrapper>();
        
        assignExistedData();
       
        set<Id> accIds = new set<Id>();
        for(Account ac: marketingRepAccMap.values())
            accIds.add(ac.Id);
        list<String> args = new String[]{'0','number','###,###,##0.00'};
        for(Account ac: marketingRepAccMap.values())
        {
            GamePlanResultsWrapper wr = new GamePlanResultsWrapper();
            decimal orgTotal = null;       
            wr.acc = ac; 
            if(ac.Opportunities != null && ac.Opportunities.size() > 0)
            {
                orgTotal = 0;
                for(Opportunity opp :ac.Opportunities)
                {       
                    if(opp.Game_Plan_Amount__c != null)
                        orgTotal += opp.Game_Plan_Amount__c;
                        
                    if(ff1 != null && opp.Fund_Product__c == ff1.Id)
                        wr.opp1 = opp;
                    else if(ff2 != null && opp.Fund_Product__c == ff2.Id)
                    	wr.opp2 = opp;
                    else if(ff3 != null && opp.Fund_Product__c == ff3.Id)
                    	wr.opp3 = opp;
                    else if(ff4 != null && opp.Fund_Product__c == ff4.Id)
                    	wr.opp4 = opp;
                    else if(ff5 != null && opp.Fund_Product__c == ff5.Id)
                    	wr.opp5 = opp;
                    else if(ff6 != null && opp.Fund_Product__c == ff6.Id)
                    	wr.opp6 = opp;
                    else if(ff7 != null && opp.Fund_Product__c == ff7.Id)
                    	wr.opp7 = opp;
                    else if(ff8 != null && opp.Fund_Product__c == ff8.Id)
                    	wr.opp8 = opp;
                    else if(ff9 != null && opp.Fund_Product__c == ff9.Id)
                    	wr.opp9 = opp;
                    else if(ff10 != null && opp.Fund_Product__c == ff10.Id)
                    	wr.opp10 = opp;
                    else if(ff11 != null && opp.Fund_Product__c == ff11.Id)
                    	wr.opp11 = opp;	
                    else if(ff12 != null && opp.Fund_Product__c == ff12.Id)
                    	wr.opp12 = opp;	
                    else if(ff13 != null && opp.Fund_Product__c == ff13.Id)
                    	wr.opp13 = opp;	
                    else if(ff14 != null && opp.Fund_Product__c == ff14.Id)
                    	wr.opp14 = opp;	
                    else if(ff15 != null && opp.Fund_Product__c == ff15.Id)
                    	wr.opp15 = opp;	
                    else if(ff16 != null && opp.Fund_Product__c == ff16.Id)
                    	wr.opp16 = opp;	
                    else if(ff17 != null && opp.Fund_Product__c == ff17.Id)
                    	wr.opp17 = opp;	
                    else if(ff18 != null && opp.Fund_Product__c == ff18.Id)
                    	wr.opp18 = opp;
                    else if(ff19 != null && opp.Fund_Product__c == ff19.Id)
                    	wr.opp19 = opp;	
                    else if(ff20 != null && opp.Fund_Product__c == ff20.Id)
                    	wr.opp20 = opp;
                    else if(ff21 != null && opp.Fund_Product__c == ff21.Id)
                    	wr.opp21 = opp;	
                    else if(ff22 != null && opp.Fund_Product__c == ff22.Id)
                    	wr.opp22 = opp;	
                    else if(ff23 != null && opp.Fund_Product__c == ff23.Id)
                    	wr.opp23 = opp;	
                    else if(ff24 != null && opp.Fund_Product__c == ff24.Id)
                    	wr.opp24 = opp;	
                    else if(ff25 != null && opp.Fund_Product__c == ff25.Id)
                    	wr.opp25 = opp;	
                    else if(ff26 != null && opp.Fund_Product__c == ff26.Id)
                    	wr.opp26 = opp;	
                    else if(ff27 != null && opp.Fund_Product__c == ff27.Id)
                    	wr.opp27 = opp;	
                    else if(ff28 != null && opp.Fund_Product__c == ff28.Id)
                    	wr.opp28 = opp;
                    else if(ff29 != null && opp.Fund_Product__c == ff29.Id)
                    	wr.opp29 = opp;	
                    else if(ff30 != null && opp.Fund_Product__c == ff30.Id)
                    	wr.opp30 = opp;
                    else if(ff31 != null && opp.Fund_Product__c == ff31.Id)
                    	wr.opp31 = opp;	
                    else if(ff32 != null && opp.Fund_Product__c == ff32.Id)
                    	wr.opp32 = opp;	
                    else if(ff33 != null && opp.Fund_Product__c == ff33.Id)
                    	wr.opp33 = opp;	
                    else if(ff34 != null && opp.Fund_Product__c == ff34.Id)
                    	wr.opp34 = opp;	
                    else if(ff35 != null && opp.Fund_Product__c == ff35.Id)
                    	wr.opp35 = opp;	
                    else if(ff36 != null && opp.Fund_Product__c == ff36.Id)
                    	wr.opp36 = opp;	
                    else if(ff37 != null && opp.Fund_Product__c == ff37.Id)
                    	wr.opp37 = opp;	
                    else if(ff38 != null && opp.Fund_Product__c == ff38.Id)
                    	wr.opp38 = opp;
                    else if(ff39 != null && opp.Fund_Product__c == ff39.Id)
                    	wr.opp39 = opp;	
                    else if(ff40 != null && opp.Fund_Product__c == ff40.Id)
                    	wr.opp40 = opp;
                    else if(ff41 != null && opp.Fund_Product__c == ff41.Id)
                    	wr.opp41 = opp;	
                    else if(ff42 != null && opp.Fund_Product__c == ff42.Id)
                    	wr.opp42 = opp;	
                    else if(ff43 != null && opp.Fund_Product__c == ff43.Id)
                    	wr.opp43 = opp;	
                    else if(ff44 != null && opp.Fund_Product__c == ff44.Id)
                    	wr.opp44 = opp;	
                    else if(ff45 != null && opp.Fund_Product__c == ff45.Id)
                    	wr.opp45 = opp;	
                    else if(ff46 != null && opp.Fund_Product__c == ff46.Id)
                    	wr.opp46 = opp;	
                    else if(ff47 != null && opp.Fund_Product__c == ff47.Id)
                    	wr.opp47 = opp;	
                    else if(ff48 != null && opp.Fund_Product__c == ff48.Id)
                    	wr.opp48 = opp;
                    else if(ff49 != null && opp.Fund_Product__c == ff49.Id)
                    	wr.opp49 = opp;	
                    else if(ff50 != null && opp.Fund_Product__c == ff50.Id)
                    	wr.opp50 = opp;
                }
            }
            wr.acc.Primary_Strategy_AUM_currency__c = orgTotal;
            results.add(wr);            
        }
        //resultsTemp.addAll(results);
        resultsTotal = grandTotal();
        if(isSaveClicked == true && filterInputEvent != null && string.isNotEmpty(filterInputEvent.Subject__c))
        {
        	sortBy = filterInputEvent.Subject__c;
        	results.sort();
        	if(!sortAscending) 
            {
                list<GamePlanResultsWrapper> cloneList = results.clone();
                Integer size = results.size();
                for(Integer i=0; i < size; i++) {
                    results[i] = cloneList[size-1-i];
                }
            }
        }
    }

    private GamePlanResultsWrapper grandTotal()
    {
        list<GamePlanResultsWrapper> gprwList = new list<GamePlanResultsWrapper>();
        for(Account ac: footerMarketingRepAccMap.values())
        {
            GamePlanResultsWrapper wr = new GamePlanResultsWrapper();                        
            if(ac.Opportunities != null && ac.Opportunities.size() > 0)
            {
                for(Opportunity opp :ac.Opportunities)
                {       
                    if(opp.Game_Plan_Amount__c != null)
                    {                       
                        if(ff1 != null && opp.Fund_Product__c == ff1.Id)                        
                            wr.opp1 = opp;//wr.fund1 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff2 != null && opp.Fund_Product__c == ff2.Id)
                            wr.opp2 = opp;//wr.fund2 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff3 != null && opp.Fund_Product__c == ff3.Id)
                            wr.opp3 = opp;//wr.fund3 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff4 != null && opp.Fund_Product__c == ff4.Id)
                            wr.opp4 = opp;//wr.fund4 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff5 != null && opp.Fund_Product__c == ff5.Id)
                            wr.opp5 = opp;//wr.fund5 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff6 != null && opp.Fund_Product__c == ff6.Id)
                            wr.opp6 = opp;//wr.fund6 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff7 != null && opp.Fund_Product__c == ff7.Id)
                            wr.opp7 = opp;//wr.fund7 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff8 != null && opp.Fund_Product__c == ff8.Id)
                            wr.opp8 = opp;//wr.fund8 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff9 != null && opp.Fund_Product__c == ff9.Id)
                            wr.opp9 = opp;//wr.fund9 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff10 != null && opp.Fund_Product__c == ff10.Id)
                            wr.opp10 = opp;//wr.fund10 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff11 != null && opp.Fund_Product__c == ff11.Id)
                            wr.opp11 = opp;//wr.fund11 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff12 != null && opp.Fund_Product__c == ff12.Id)
                            wr.opp12 = opp;//wr.fund12 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff13 != null && opp.Fund_Product__c == ff13.Id)
                            wr.opp13 = opp;//wr.fund13 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff14 != null && opp.Fund_Product__c == ff14.Id)
                            wr.opp14 = opp;//wr.fund14 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff15 != null && opp.Fund_Product__c == ff15.Id)
                            wr.opp15 = opp;//wr.fund15 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff16 != null && opp.Fund_Product__c == ff16.Id)
                            wr.opp16 = opp;//wr.fund16 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff17 != null && opp.Fund_Product__c == ff17.Id)
                            wr.opp17 = opp;//wr.fund17 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff18 != null && opp.Fund_Product__c == ff18.Id)
                            wr.opp18 = opp;//wr.fund18 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff19 != null && opp.Fund_Product__c == ff19.Id)
                            wr.opp19 = opp;//wr.fund19 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff20 != null && opp.Fund_Product__c == ff20.Id)
                            wr.opp20 = opp;//wr.fund20 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff21 != null && opp.Fund_Product__c == ff21.Id)
                            wr.opp21 = opp;//wr.fund21 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff22 != null && opp.Fund_Product__c == ff22.Id)
                            wr.opp22 = opp;//wr.fund22 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff23 != null && opp.Fund_Product__c == ff23.Id)
                            wr.opp23 = opp;//wr.fund23 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff24 != null && opp.Fund_Product__c == ff24.Id)
                            wr.opp24 = opp;//wr.fund24 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff25 != null && opp.Fund_Product__c == ff25.Id)
                            wr.opp25 = opp;//wr.fund25 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff26 != null && opp.Fund_Product__c == ff26.Id)
                            wr.opp26 = opp;//wr.fund26 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff27 != null && opp.Fund_Product__c == ff27.Id)
                            wr.opp27 = opp;//wr.fund27 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff28 != null && opp.Fund_Product__c == ff28.Id)
                            wr.opp28 = opp;//wr.fund28 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff29 != null && opp.Fund_Product__c == ff29.Id)
                            wr.opp29 = opp;//wr.fund29 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff30 != null && opp.Fund_Product__c == ff30.Id)
                            wr.opp30 = opp;//wr.fund30 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff31 != null && opp.Fund_Product__c == ff31.Id)
                            wr.opp31 = opp;//wr.fund31 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff32 != null && opp.Fund_Product__c == ff32.Id)
                            wr.opp32 = opp;//wr.fund32 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff33 != null && opp.Fund_Product__c == ff33.Id)
                            wr.opp33 = opp;//wr.fund33 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff34 != null && opp.Fund_Product__c == ff34.Id)
                            wr.opp34 = opp;//wr.fund34 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff35 != null && opp.Fund_Product__c == ff35.Id)
                            wr.opp35 = opp;//wr.fund35 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff36 != null && opp.Fund_Product__c == ff36.Id)
                            wr.opp36 = opp;//wr.fund36 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff37 != null && opp.Fund_Product__c == ff37.Id)
                            wr.opp37 = opp;//wr.fund37 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff38 != null && opp.Fund_Product__c == ff38.Id)
                            wr.opp38 = opp;//wr.fund38 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff39 != null && opp.Fund_Product__c == ff39.Id)
                            wr.opp39 = opp;//wr.fund39 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff40 != null && opp.Fund_Product__c == ff40.Id)
                            wr.opp40 = opp;//wr.fund40 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff41 != null && opp.Fund_Product__c == ff41.Id)
                            wr.opp41 = opp;//wr.fund41 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff42 != null && opp.Fund_Product__c == ff42.Id)
                            wr.opp42 = opp;//wr.fund42 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff43 != null && opp.Fund_Product__c == ff43.Id)
                            wr.opp43 = opp;//wr.fund43 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff44 != null && opp.Fund_Product__c == ff44.Id)
                            wr.opp44 = opp;//wr.fund44 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff45 != null && opp.Fund_Product__c == ff45.Id)
                            wr.opp45 = opp;//wr.fund45 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff46 != null && opp.Fund_Product__c == ff46.Id)
                            wr.opp46 = opp;//wr.fund46 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff47 != null && opp.Fund_Product__c == ff47.Id)
                            wr.opp47 = opp;//wr.fund47 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff48 != null && opp.Fund_Product__c == ff48.Id)
                            wr.opp48 = opp;//wr.fund48 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff49 != null && opp.Fund_Product__c == ff49.Id)
                            wr.opp49 = opp;//wr.fund49 = string.valueOf(opp.Game_Plan_Amount__c);
                        else if(ff50 != null && opp.Fund_Product__c == ff50.Id)
                            wr.opp50 = opp;//wr.fund50 = string.valueOf(opp.Game_Plan_Amount__c);
                    }
                }
            }
            gprwList.add(wr);
        }
        GamePlanResultsWrapper resultsTotalSet = new GamePlanResultsWrapper();
        for(GamePlanResultsWrapper gp: gprwList)
        {
            Opportunity locOpp = new Opportunity();
            if(gp.opp1 != null && gp.opp1.Game_Plan_Amount__c != null)                
            {                
                if(resultsTotalSet.opp1 != null)
                {                
                	locOpp = resultsTotalSet.opp1;
                	locOpp.Game_Plan_Amount__c = gp.opp1.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp1;
                	resultsTotalSet.opp1 = locOpp;
                }	
            }
            if(gp.opp2 != null && gp.opp2.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp2 != null)
                {                
                	locOpp = resultsTotalSet.opp2;
                	locOpp.Game_Plan_Amount__c = gp.opp2.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp2;
                	resultsTotalSet.opp2 = locOpp;
                }                
            }
            if(gp.opp3 != null && gp.opp3.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp3 != null)
                {                
                	locOpp = resultsTotalSet.opp3;
                	locOpp.Game_Plan_Amount__c = gp.opp3.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp3;
                	resultsTotalSet.opp3 = locOpp;
                }
            }
            if(gp.opp4 != null && gp.opp4.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp4 != null)
                {                
                	locOpp = resultsTotalSet.opp4;
                	locOpp.Game_Plan_Amount__c = gp.opp4.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp4;
                	resultsTotalSet.opp4 = locOpp;
                }
            }
            if(gp.opp5 != null && gp.opp5.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp5 != null)
                {                
                	locOpp = resultsTotalSet.opp5;
                	locOpp.Game_Plan_Amount__c = gp.opp5.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp5;
                	resultsTotalSet.opp5 = locOpp;
                }
            }
            if(gp.opp6 != null && gp.opp6.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp6 != null)
                {                
                	locOpp = resultsTotalSet.opp6;
                	locOpp.Game_Plan_Amount__c = gp.opp6.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp6;
                	resultsTotalSet.opp6 = locOpp;
                }
            }
            if(gp.opp7 != null && gp.opp7.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp7 != null)
                {                
                	locOpp = resultsTotalSet.opp7;
                	locOpp.Game_Plan_Amount__c = gp.opp7.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp7;
                	resultsTotalSet.opp7 = locOpp;
                }
            }
            if(gp.opp8 != null && gp.opp8.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp8 != null)
                {                
                	locOpp = resultsTotalSet.opp8;
                	locOpp.Game_Plan_Amount__c = gp.opp8.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp8;
                	resultsTotalSet.opp8 = locOpp;
                }
            }
            if(gp.opp9 != null && gp.opp9.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp9 != null)
                {                
                	locOpp = resultsTotalSet.opp9;
                	locOpp.Game_Plan_Amount__c = gp.opp9.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp9;
                	resultsTotalSet.opp9 = locOpp;
                }
            }
            if(gp.opp10 != null && gp.opp10.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp10 != null)
                {                
                	locOpp = resultsTotalSet.opp10;
                	locOpp.Game_Plan_Amount__c = gp.opp10.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp10;
                	resultsTotalSet.opp10 = locOpp;
                }
            }
            if(gp.opp11 != null && gp.opp11.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp11 != null)
                {                
                	locOpp = resultsTotalSet.opp11;
                	locOpp.Game_Plan_Amount__c = gp.opp11.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp11;
                	resultsTotalSet.opp11 = locOpp;
                }
            }
            if(gp.opp12 != null && gp.opp12.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp12 != null)
                {                
                	locOpp = resultsTotalSet.opp12;
                	locOpp.Game_Plan_Amount__c = gp.opp12.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp12;
                	resultsTotalSet.opp12 = locOpp;
                }
            }
            if(gp.opp13 != null && gp.opp13.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp13 != null)
                {                
                	locOpp = resultsTotalSet.opp13;
                	locOpp.Game_Plan_Amount__c = gp.opp13.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp13;
                	resultsTotalSet.opp13 = locOpp;
                }
            }
            if(gp.opp14 != null && gp.opp14.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp14 != null)
                {                
                	locOpp = resultsTotalSet.opp14;
                	locOpp.Game_Plan_Amount__c = gp.opp14.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp14;
                	resultsTotalSet.opp14 = locOpp;
                }
            }
            if(gp.opp15 != null && gp.opp15.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp15 != null)
                {                
                	locOpp = resultsTotalSet.opp15;
                	locOpp.Game_Plan_Amount__c = gp.opp15.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp15;
                	resultsTotalSet.opp15 = locOpp;
                }
            }
            if(gp.opp16 != null && gp.opp16.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp16 != null)
                {                
                	locOpp = resultsTotalSet.opp16;
                	locOpp.Game_Plan_Amount__c = gp.opp16.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp16;
                	resultsTotalSet.opp16 = locOpp;
                }
            }
            if(gp.opp17 != null && gp.opp17.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp17 != null)
                {                
                	locOpp = resultsTotalSet.opp17;
                	locOpp.Game_Plan_Amount__c = gp.opp17.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp17;
                	resultsTotalSet.opp17 = locOpp;
                }
            }
            if(gp.opp18 != null && gp.opp18.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp18 != null)
                {                
                	locOpp = resultsTotalSet.opp18;
                	locOpp.Game_Plan_Amount__c = gp.opp18.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp18;
                	resultsTotalSet.opp18 = locOpp;
                }
            }
            if(gp.opp19 != null && gp.opp19.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp19 != null)
                {                
                	locOpp = resultsTotalSet.opp19;
                	locOpp.Game_Plan_Amount__c = gp.opp19.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp19;
                	resultsTotalSet.opp19 = locOpp;
                }
            }
            if(gp.opp20 != null && gp.opp20.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp20 != null)
                {                
                	locOpp = resultsTotalSet.opp20;
                	locOpp.Game_Plan_Amount__c = gp.opp20.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp20;
                	resultsTotalSet.opp20 = locOpp;
                }
            }
            if(gp.opp21 != null && gp.opp21.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp21 != null)
                {                
                	locOpp = resultsTotalSet.opp21;
                	locOpp.Game_Plan_Amount__c = gp.opp21.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp21;
                	resultsTotalSet.opp21 = locOpp;
                }
            }
            if(gp.opp22 != null && gp.opp22.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp22 != null)
                {                
                	locOpp = resultsTotalSet.opp22;
                	locOpp.Game_Plan_Amount__c = gp.opp22.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp22;
                	resultsTotalSet.opp22 = locOpp;
                }
            }
            if(gp.opp23 != null && gp.opp23.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp23 != null)
                {                
                	locOpp = resultsTotalSet.opp23;
                	locOpp.Game_Plan_Amount__c = gp.opp23.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp23;
                	resultsTotalSet.opp23 = locOpp;
                }
            }
            if(gp.opp24 != null && gp.opp24.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp24 != null)
                {                
                	locOpp = resultsTotalSet.opp24;
                	locOpp.Game_Plan_Amount__c = gp.opp24.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp24;
                	resultsTotalSet.opp24 = locOpp;
                }
            }
            if(gp.opp25 != null && gp.opp25.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp25 != null)
                {                
                	locOpp = resultsTotalSet.opp25;
                	locOpp.Game_Plan_Amount__c = gp.opp25.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp25;
                	resultsTotalSet.opp25 = locOpp;
                }
            }
            if(gp.opp26 != null && gp.opp26.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp26 != null)
                {                
                	locOpp = resultsTotalSet.opp26;
                	locOpp.Game_Plan_Amount__c = gp.opp26.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp26;
                	resultsTotalSet.opp26 = locOpp;
                }
            }
            if(gp.opp27 != null && gp.opp27.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp27 != null)
                {                
                	locOpp = resultsTotalSet.opp27;
                	locOpp.Game_Plan_Amount__c = gp.opp27.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp27;
                	resultsTotalSet.opp27 = locOpp;
                }
            }
            if(gp.opp28 != null && gp.opp28.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp28 != null)
                {                
                	locOpp = resultsTotalSet.opp28;
                	locOpp.Game_Plan_Amount__c = gp.opp28.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp28;
                	resultsTotalSet.opp28 = locOpp;
                }
            }
            if(gp.opp29 != null && gp.opp29.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp29 != null)
                {                
                	locOpp = resultsTotalSet.opp29;
                	locOpp.Game_Plan_Amount__c = gp.opp29.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp29;
                	resultsTotalSet.opp29 = locOpp;
                }
            }
            if(gp.opp30 != null && gp.opp30.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp30 != null)
                {                
                	locOpp = resultsTotalSet.opp30;
                	locOpp.Game_Plan_Amount__c = gp.opp30.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp30;
                	resultsTotalSet.opp30 = locOpp;
                }
            }
            if(gp.opp31 != null && gp.opp31.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp31 != null)
                {                
                	locOpp = resultsTotalSet.opp31;
                	locOpp.Game_Plan_Amount__c = gp.opp31.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp31;
                	resultsTotalSet.opp31 = locOpp;
                }
            }
            if(gp.opp32 != null && gp.opp32.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp32 != null)
                {                
                	locOpp = resultsTotalSet.opp32;
                	locOpp.Game_Plan_Amount__c = gp.opp32.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp32;
                	resultsTotalSet.opp32 = locOpp;
                }
            }
            if(gp.opp33 != null && gp.opp33.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp33 != null)
                {                
                	locOpp = resultsTotalSet.opp33;
                	locOpp.Game_Plan_Amount__c = gp.opp33.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp33;
                	resultsTotalSet.opp33 = locOpp;
                }
            }
            if(gp.opp34 != null && gp.opp34.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp34 != null)
                {                
                	locOpp = resultsTotalSet.opp34;
                	locOpp.Game_Plan_Amount__c = gp.opp34.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp34;
                	resultsTotalSet.opp34 = locOpp;
                }
            }
            if(gp.opp35 != null && gp.opp35.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp35 != null)
                {                
                	locOpp = resultsTotalSet.opp35;
                	locOpp.Game_Plan_Amount__c = gp.opp35.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp35;
                	resultsTotalSet.opp35 = locOpp;
                }
            }
            if(gp.opp36 != null && gp.opp36.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp36 != null)
                {                
                	locOpp = resultsTotalSet.opp36;
                	locOpp.Game_Plan_Amount__c = gp.opp36.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp36;
                	resultsTotalSet.opp36 = locOpp;
                }
            }
            if(gp.opp37 != null && gp.opp37.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp37 != null)
                {                
                	locOpp = resultsTotalSet.opp37;
                	locOpp.Game_Plan_Amount__c = gp.opp37.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp37;
                	resultsTotalSet.opp37 = locOpp;
                }
            }
            if(gp.opp38 != null && gp.opp38.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp38 != null)
                {                
                	locOpp = resultsTotalSet.opp38;
                	locOpp.Game_Plan_Amount__c = gp.opp38.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp38;
                	resultsTotalSet.opp38 = locOpp;
                }
            }
            if(gp.opp39 != null && gp.opp39.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp39 != null)
                {                
                	locOpp = resultsTotalSet.opp39;
                	locOpp.Game_Plan_Amount__c = gp.opp39.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp39;
                	resultsTotalSet.opp39 = locOpp;
                }
            }
            if(gp.opp40 != null && gp.opp40.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp40 != null)
                {                
                	locOpp = resultsTotalSet.opp40;
                	locOpp.Game_Plan_Amount__c = gp.opp40.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp40;
                	resultsTotalSet.opp40 = locOpp;
                }
            } 
			if(gp.opp41 != null && gp.opp41.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp41 != null)
                {                
                	locOpp = resultsTotalSet.opp41;
                	locOpp.Game_Plan_Amount__c = gp.opp41.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp41;
                	resultsTotalSet.opp41 = locOpp;
                }
            }
            if(gp.opp42 != null && gp.opp42.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp42 != null)
                {                
                	locOpp = resultsTotalSet.opp42;
                	locOpp.Game_Plan_Amount__c = gp.opp42.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp42;
                	resultsTotalSet.opp42 = locOpp;
                }
            }
            if(gp.opp43 != null && gp.opp43.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp43 != null)
                {                
                	locOpp = resultsTotalSet.opp43;
                	locOpp.Game_Plan_Amount__c = gp.opp43.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp43;
                	resultsTotalSet.opp43 = locOpp;
                }
            }
            if(gp.opp44 != null && gp.opp44.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp44 != null)
                {                
                	locOpp = resultsTotalSet.opp44;
                	locOpp.Game_Plan_Amount__c = gp.opp44.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp44;
                	resultsTotalSet.opp44 = locOpp;
                }
            }
            if(gp.opp45 != null && gp.opp45.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp45 != null)
                {                
                	locOpp = resultsTotalSet.opp45;
                	locOpp.Game_Plan_Amount__c = gp.opp45.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp45;
                	resultsTotalSet.opp45 = locOpp;
                }
            }
            if(gp.opp46 != null && gp.opp46.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp46 != null)
                {                
                	locOpp = resultsTotalSet.opp46;
                	locOpp.Game_Plan_Amount__c = gp.opp46.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp46;
                	resultsTotalSet.opp46 = locOpp;
                }
            }
            if(gp.opp47 != null && gp.opp47.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp47 != null)
                {                
                	locOpp = resultsTotalSet.opp47;
                	locOpp.Game_Plan_Amount__c = gp.opp47.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp47;
                	resultsTotalSet.opp47 = locOpp;
                }
            }
            if(gp.opp48 != null && gp.opp48.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp48 != null)
                {                
                	locOpp = resultsTotalSet.opp48;
                	locOpp.Game_Plan_Amount__c = gp.opp48.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp48;
                	resultsTotalSet.opp48 = locOpp;
                }
            }
            if(gp.opp49 != null && gp.opp49.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp49 != null)
                {                
                	locOpp = resultsTotalSet.opp49;
                	locOpp.Game_Plan_Amount__c = gp.opp49.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp49;
                	resultsTotalSet.opp49 = locOpp;
                }
            }
            if(gp.opp50 != null && gp.opp50.Game_Plan_Amount__c != null) 
            {
                if(resultsTotalSet.opp50 != null)
                {                
                	locOpp = resultsTotalSet.opp50;
                	locOpp.Game_Plan_Amount__c = gp.opp50.Game_Plan_Amount__c + locOpp.Game_Plan_Amount__c;
                }
                else
                {	
                	locOpp = gp.opp50;
                	resultsTotalSet.opp50 = locOpp;
                }
            }  
        }
        return resultsTotalSet;
    }
     
    private void assignExistedData()
    {
        //fundNamesList = new map<Id, ocm_FundFamily__c>([Select o.Name, o.Id, o.Fund_Family_Abbreviation__c, o.Fund_Product_Marketing_Name__c, o.Fund_Family__c, o.Fund_Family__r.Name From ocm_FundFamily__c o where (Marketing_Status__c = 'Active' OR Marketing_Status__c = 'Pending') order by Strategy__r.Name, Name]);
        fundNamesList = new map<Id, ocm_FundFamily__c>([Select o.Name, o.Id, o.Fund_Family_Abbreviation__c, o.Fund_Product_Marketing_Name__c, o.Fund_Family__c, o.Fund_Family__r.Name From ocm_FundFamily__c o where (Fund_Product_Marketing_Name__c != null AND (Marketing_Status__c = 'Active' OR Marketing_Status__c = 'Pending')) order by Fund_Product_Marketing_Name__c asc]);
        assignFundData(fundNamesList.values());

        User userName = [select Name from User where id=:acc.Primary_Marketing_Representative__c limit 1]; 
        marketingRepName = userName.Name;

        gamePlanOppRecId = [Select Id From RecordType Where SObjectType =: OCM_Constants.SOBJECT_NAME_OPPORTUNITY AND DeveloperName =: OCM_Constants.OCM_RT_OPPORTUNITY_GAME_PLAN limit 1].id;
        
        if(string.isNotBlank(popupOrgId))
            marketingRepAccMap = new map<id, Account>([select id, Name, Activity_Status__c, RecordType.Name, Marketing_Comments__c, Fund_Families_Invested_In__c, (Select Id, Organization__c, Ranking__c, Type__c, Year__c From Marketing_Rankings__r where Year__c = :opp.Game_Plan_Year__c), (Select Id, StageName, Amount, Game_Plan_Amount__c, Fund_Product__c, Fund_Product__r.Name, Game_Plan_Year__c From Opportunities where Game_Plan_Year__c = :opp.Game_Plan_Year__c AND Fund_Product__c IN :fundIds AND RecordType.DeveloperName = :OCM_Constants.OCM_RT_OPPORTUNITY_GAME_PLAN) from Account where (Primary_Marketing_Representative__c = :acc.Primary_Marketing_Representative__c AND Id = :popupOrgId) order by Name]);  
        else
        {   
            list<Id> soqlFFIds = new list<Id>();
            soqlFFIds.addAll(fundIds);
            String whereClause = '';
        
            if(selectedAcc != null && selectedAcc != '')
                whereClause = ' RecordType.DeveloperName = \''+selectedAcc+'\'';
            else
                whereClause = ' RecordType.DeveloperName != \''+OCM_Constants.OCM_PARENT_CLIENT_DEV+'\'';

            if(string.isNotEmpty(selectedActivityStatus))
                whereClause += ' AND Activity_Status__c = \''+selectedActivityStatus+'\'';
            
            String marketingRepAccMapSoql = 'Select id, Name, Activity_Status__c, RecordType.Name, Marketing_Comments__c, Fund_Families_Invested_In__c, (Select Id, Organization__c, Ranking__c, Type__c, Year__c From Marketing_Rankings__r where Year__c = \''+opp.Game_Plan_Year__c+'\'), (Select Id, StageName, Amount, Game_Plan_Amount__c, Fund_Product__c, Fund_Product__r.Name, Game_Plan_Year__c From Opportunities where Game_Plan_Year__c = \''+opp.Game_Plan_Year__c+'\' AND Fund_Product__c IN ('+SchemaHelper.buildIdset(soqlFFIds)+') AND RecordType.DeveloperName = \''+OCM_Constants.OCM_RT_OPPORTUNITY_GAME_PLAN+'\') from Account where (Primary_Marketing_Representative__c = \''+acc.Primary_Marketing_Representative__c+'\' AND('+whereClause+')) order by Name limit '+list_size+' offset '+counter;        
            String footerMarketingRepAccMapSoql = 'select id, (Select Id, StageName, Amount, Game_Plan_Amount__c, Fund_Product__c, Fund_Product__r.Name, Game_Plan_Year__c From Opportunities where Game_Plan_Year__c = \''+opp.Game_Plan_Year__c+'\' AND Fund_Product__c IN ('+SchemaHelper.buildIdset(soqlFFIds)+') AND RecordType.DeveloperName = \''+OCM_Constants.OCM_RT_OPPORTUNITY_GAME_PLAN+'\') from Account where (Primary_Marketing_Representative__c = \''+acc.Primary_Marketing_Representative__c+'\'AND ('+whereClause+')) order by Name';
            
            marketingRepAccMap = new map<id, Account>((list<Account>)Database.query(marketingRepAccMapSoql));
            footerMarketingRepAccMap = new map<id, Account>((list<Account>)Database.query(footerMarketingRepAccMapSoql));
            total_size = footerMarketingRepAccMap.size();
        }
    }
    
    public list<SelectOption> getStageNames() 
    {
        list<SelectOption> options = new list<SelectOption>();
        options.add(new SelectOption('', ''));        
        options.add(new SelectOption('High', 'H'));        
        options.add(new SelectOption('Medium', 'M'));
        options.add(new SelectOption('Low', 'L'));        
        return options;
    }
    
    public list<SelectOption> getActivityStatusList() 
    {
        list<SelectOption> options = new list<SelectOption>();
        options.add(new SelectOption('', '--All--'));        
        options.add(new SelectOption('Current', 'Current'));        
        options.add(new SelectOption('No Contact 3 Months', 'No Contact 3 Months'));
        options.add(new SelectOption('No Contact 12 Months', 'No Contact 12 Months'));
        options.add(new SelectOption('Never Contacted', 'Never Contacted'));        
        return options;
    }
    
    public list<SelectOption> getAccounts() 
    {        
        list<SelectOption> options = new list<SelectOption>();
        options.add(new SelectOption('', '--All--'));
        list<RecordType> accList = [Select r.Name, r.DeveloperName From RecordType r where (SobjectType = :OCM_Constants.SOBJECT_NAME_ACCOUNT AND DeveloperName != :OCM_Constants.OCM_PARENT_CLIENT_DEV)order by Name];
        for(RecordType ac: accList)
            options.add(new SelectOption(ac.DeveloperName, ac.Name));
        return options;
    }
    
    private void assignFundData(list<ocm_FundFamily__c> ffList)
    {
        fundIds = new set<Id>();  
        for(ocm_FundFamily__c f: ffList)
            fundIds.add(f.id);

        if(ffList.size()> 0)
        	ff1 = ffList[0];   
        if(ffList.size()> 1)
            ff2 = ffList[1];
        if(ffList.size()> 2)
        	ff3 = ffList[2];
        if(ffList.size()> 3)
        	ff4 = ffList[3];
        if(ffList.size()> 4)
        	ff5 = ffList[4];
        if(ffList.size()> 5)
        	ff6 = ffList[5];
        if(ffList.size()> 6)
        	ff7 = ffList[6];
        if(ffList.size()> 7)
        	ff8 = ffList[7];
        if(ffList.size()> 8)
        	ff9 = ffList[8];	
        if(ffList.size()> 9)
        	ff10 = ffList[9];
    	if(ffList.size()> 10)
            ff11 = ffList[10];
        if(ffList.size()> 11)
            ff12 = ffList[11];
        if(ffList.size()> 12)
            ff13 = ffList[12];
        if(ffList.size()> 13)
            ff14 = ffList[13];
        if(ffList.size()> 14)
            ff15 = ffList[14];
        if(ffList.size()> 15)
            ff16 = ffList[15];
        if(ffList.size()> 16)
            ff17 = ffList[16];
        if(ffList.size()> 17)
            ff18 = ffList[17];
        if(ffList.size()> 18)
            ff19 = ffList[18];
        if(ffList.size()> 19)
            ff20 = ffList[19];
        if(ffList.size()> 20)
            ff21 = ffList[20];
        if(ffList.size()> 21)
            ff22 = ffList[21];
        if(ffList.size()> 22)
            ff23 = ffList[22];
        if(ffList.size()> 23)
            ff24 = ffList[23];
        if(ffList.size()> 24)
            ff25 = ffList[24];
        if(ffList.size()> 25)
            ff26 = ffList[25];
        if(ffList.size()> 26)
            ff27 = ffList[26];
        if(ffList.size()> 27)
            ff28 = ffList[27];
        if(ffList.size()> 28)
            ff29 = ffList[28];
        if(ffList.size()> 29)
            ff30 = ffList[29];
        if(ffList.size()> 30)
            ff31 = ffList[30];
        if(ffList.size()> 31)
            ff32 = ffList[31];
        if(ffList.size()> 32)
            ff33 = ffList[32];
        if(ffList.size()> 33)
            ff34 = ffList[33];
        if(ffList.size()> 34)
            ff35 = ffList[34];
        if(ffList.size()> 35)
            ff36 = ffList[35];
        if(ffList.size()> 36)
            ff37 = ffList[36];
        if(ffList.size()> 37)
            ff38 = ffList[37];
        if(ffList.size()> 38)
            ff39 = ffList[38];
        if(ffList.size()> 39)
            ff40 = ffList[39];
        if(ffList.size()> 40)
            ff41 = ffList[40];
        if(ffList.size()> 41)
            ff42 = ffList[41];
        if(ffList.size()> 42)
            ff43 = ffList[42];
        if(ffList.size()> 43)
            ff44 = ffList[43];
        if(ffList.size()> 44)
            ff45 = ffList[44];
        if(ffList.size()> 45)
            ff46 = ffList[45];
        if(ffList.size()> 46)
            ff47 = ffList[46];
        if(ffList.size()> 47)
            ff48 = ffList[47];
        if(ffList.size()> 48)
            ff49 = ffList[48];
        if(ffList.size()> 49)
            ff50 = ffList[49];    
    }
    
    public void filter() 
    {
        isSaveClicked = false;
        loadData();
    } 
    
    public PageReference save()
    {
        Savepoint sp = Database.setSavepoint();
        isSaveClicked = true;
        try
        {
            if(!(String.isEmpty(opp.Game_Plan_Year__c)) && acc.Primary_Marketing_Representative__c != null)
            {
                if(pageValidations() == true)
                {
                    set<Opportunity> updateOppSet = new set<Opportunity>();
                    if(results != null && results.size()>0)
                    {
                        assignExistedData();
                        for(GamePlanResultsWrapper gw: results)
                        {                                               
                            if(gw.acc != null)
                            {                           
                                //Opportunities
                                if(marketingRepAccMap != null && (marketingRepAccMap.get(gw.acc.Id).Opportunities != null && marketingRepAccMap.get(gw.acc.Id).Opportunities.size()>0))
                                {
                                    for(Opportunity op: marketingRepAccMap.get(gw.acc.Id).Opportunities)
                                    {
                                        Opportunity updatedOpp = new Opportunity(Id = op.Id);
                                        updatedOpp.OwnerId = acc.Primary_Marketing_Representative__c;
                                        if(ff1 != null && op.Fund_Product__c == ff1.Id && gw.opp1 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp1.Game_Plan_Amount__c || op.StageName != gw.opp1.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp1.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp1.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }
                                        }
                                        else if(ff2 != null && op.Fund_Product__c == ff2.Id && gw.opp2 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp2.Game_Plan_Amount__c || op.StageName != gw.opp2.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp2.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp2.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff3 != null && op.Fund_Product__c == ff3.Id && gw.opp3 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp3.Game_Plan_Amount__c || op.StageName != gw.opp3.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp3.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp3.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }
                                        }
                                        else if(ff4 != null && op.Fund_Product__c == ff4.Id && gw.opp4 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp4.Game_Plan_Amount__c || op.StageName != gw.opp4.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp4.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp4.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }                                           
                                        }
                                        else if(ff5 != null && op.Fund_Product__c == ff5.Id && gw.opp5 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp5.Game_Plan_Amount__c || op.StageName != gw.opp5.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp5.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp5.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff6 != null && op.Fund_Product__c == ff6.Id && gw.opp6 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp6.Game_Plan_Amount__c || op.StageName != gw.opp6.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp6.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp6.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff7 != null && op.Fund_Product__c == ff7.Id && gw.opp7 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp7.Game_Plan_Amount__c || op.StageName != gw.opp7.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp7.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp7.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff8 != null && op.Fund_Product__c == ff8.Id && gw.opp8 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp8.Game_Plan_Amount__c || op.StageName != gw.opp8.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp8.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp8.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff9 != null && op.Fund_Product__c == ff9.Id && gw.opp9 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp9.Game_Plan_Amount__c || op.StageName != gw.opp9.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp9.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp9.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff10 != null && op.Fund_Product__c == ff10.Id && gw.opp10 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp10.Game_Plan_Amount__c || op.StageName != gw.opp10.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp10.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp10.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff11 != null && op.Fund_Product__c == ff11.Id && gw.opp11 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp11.Game_Plan_Amount__c || op.StageName != gw.opp11.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp11.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp11.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff12 != null && op.Fund_Product__c == ff12.Id && gw.opp12 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp12.Game_Plan_Amount__c || op.StageName != gw.opp12.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp12.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp12.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff13 != null && op.Fund_Product__c == ff13.Id && gw.opp13 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp13.Game_Plan_Amount__c || op.StageName != gw.opp13.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp13.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp13.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff14 != null && op.Fund_Product__c == ff14.Id && gw.opp14 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp14.Game_Plan_Amount__c || op.StageName != gw.opp14.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp14.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp14.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff15 != null && op.Fund_Product__c == ff15.Id && gw.opp15 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp15.Game_Plan_Amount__c || op.StageName != gw.opp15.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp15.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp15.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff16 != null && op.Fund_Product__c == ff16.Id && gw.opp16 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp16.Game_Plan_Amount__c || op.StageName != gw.opp16.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp16.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp16.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff17 != null && op.Fund_Product__c == ff17.Id && gw.opp17 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp17.Game_Plan_Amount__c || op.StageName != gw.opp17.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp17.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp17.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff18 != null && op.Fund_Product__c == ff18.Id && gw.opp18 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp18.Game_Plan_Amount__c || op.StageName != gw.opp18.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp18.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp18.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff19 != null && op.Fund_Product__c == ff19.Id && gw.opp19 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp19.Game_Plan_Amount__c || op.StageName != gw.opp19.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp19.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp19.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff20 != null && op.Fund_Product__c == ff20.Id && gw.opp20 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp20.Game_Plan_Amount__c || op.StageName != gw.opp20.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp20.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp20.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff21 != null && op.Fund_Product__c == ff21.Id && gw.opp21 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp21.Game_Plan_Amount__c || op.StageName != gw.opp21.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp21.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp21.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff22 != null && op.Fund_Product__c == ff22.Id && gw.opp22 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp22.Game_Plan_Amount__c || op.StageName != gw.opp22.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp22.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp22.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff23 != null && op.Fund_Product__c == ff23.Id && gw.opp23 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp23.Game_Plan_Amount__c || op.StageName != gw.opp23.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp23.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp23.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff24 != null && op.Fund_Product__c == ff24.Id && gw.opp24 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp24.Game_Plan_Amount__c || op.StageName != gw.opp24.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp24.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp24.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff25 != null && op.Fund_Product__c == ff25.Id && gw.opp25 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp25.Game_Plan_Amount__c || op.StageName != gw.opp25.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp25.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp25.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff26 != null && op.Fund_Product__c == ff26.Id && gw.opp26 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp26.Game_Plan_Amount__c || op.StageName != gw.opp26.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp26.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp26.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff27 != null && op.Fund_Product__c == ff27.Id && gw.opp27 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp27.Game_Plan_Amount__c || op.StageName != gw.opp27.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp27.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp27.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff28 != null && op.Fund_Product__c == ff28.Id && gw.opp28 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp28.Game_Plan_Amount__c || op.StageName != gw.opp28.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp28.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp28.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff29 != null && op.Fund_Product__c == ff29.Id && gw.opp29 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp29.Game_Plan_Amount__c || op.StageName != gw.opp29.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp29.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp29.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff30 != null && op.Fund_Product__c == ff30.Id && gw.opp30 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp30.Game_Plan_Amount__c || op.StageName != gw.opp30.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp30.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp30.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff31 != null && op.Fund_Product__c == ff31.Id && gw.opp31 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp31.Game_Plan_Amount__c || op.StageName != gw.opp31.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp31.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp31.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff32 != null && op.Fund_Product__c == ff32.Id && gw.opp32 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp32.Game_Plan_Amount__c || op.StageName != gw.opp32.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp32.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp32.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff33 != null && op.Fund_Product__c == ff33.Id && gw.opp33 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp33.Game_Plan_Amount__c || op.StageName != gw.opp33.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp33.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp33.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff34 != null && op.Fund_Product__c == ff34.Id && gw.opp34 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp34.Game_Plan_Amount__c || op.StageName != gw.opp34.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp34.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp34.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff35 != null && op.Fund_Product__c == ff35.Id && gw.opp35 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp35.Game_Plan_Amount__c || op.StageName != gw.opp35.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp35.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp35.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff36 != null && op.Fund_Product__c == ff36.Id && gw.opp36 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp36.Game_Plan_Amount__c || op.StageName != gw.opp36.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp36.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp36.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff37 != null && op.Fund_Product__c == ff37.Id && gw.opp37 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp37.Game_Plan_Amount__c || op.StageName != gw.opp37.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp37.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp37.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff38 != null && op.Fund_Product__c == ff38.Id && gw.opp38 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp38.Game_Plan_Amount__c || op.StageName != gw.opp38.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp38.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp38.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff39 != null && op.Fund_Product__c == ff39.Id && gw.opp39 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp39.Game_Plan_Amount__c || op.StageName != gw.opp39.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp39.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp39.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff40 != null && op.Fund_Product__c == ff40.Id && gw.opp40 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp40.Game_Plan_Amount__c || op.StageName != gw.opp40.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp40.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp40.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff41 != null && op.Fund_Product__c == ff41.Id && gw.opp41 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp41.Game_Plan_Amount__c || op.StageName != gw.opp41.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp41.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp41.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff42 != null && op.Fund_Product__c == ff42.Id && gw.opp42 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp42.Game_Plan_Amount__c || op.StageName != gw.opp42.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp42.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp42.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff43 != null && op.Fund_Product__c == ff43.Id && gw.opp43 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp43.Game_Plan_Amount__c || op.StageName != gw.opp43.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp43.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp43.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff44 != null && op.Fund_Product__c == ff44.Id && gw.opp44 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp44.Game_Plan_Amount__c || op.StageName != gw.opp44.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp44.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp44.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff45 != null && op.Fund_Product__c == ff45.Id && gw.opp45 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp45.Game_Plan_Amount__c || op.StageName != gw.opp45.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp45.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp45.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff46 != null && op.Fund_Product__c == ff46.Id && gw.opp46 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp46.Game_Plan_Amount__c || op.StageName != gw.opp46.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp46.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp46.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff47 != null && op.Fund_Product__c == ff47.Id && gw.opp47 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp47.Game_Plan_Amount__c || op.StageName != gw.opp47.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp47.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp47.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff48 != null && op.Fund_Product__c == ff48.Id && gw.opp48 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp48.Game_Plan_Amount__c || op.StageName != gw.opp48.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp48.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp48.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff49 != null && op.Fund_Product__c == ff49.Id && gw.opp49 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp49.Game_Plan_Amount__c || op.StageName != gw.opp49.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp49.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp49.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }
                                        else if(ff50 != null && op.Fund_Product__c == ff50.Id && gw.opp50 != null)
                                        {
                                            if(op.Game_Plan_Amount__c != gw.opp50.Game_Plan_Amount__c || op.StageName != gw.opp50.StageName)
                                            {
                                                updatedOpp.Game_Plan_Amount__c = gw.opp50.Game_Plan_Amount__c;
                                                updatedOpp.StageName = gw.opp50.StageName;
                                                updateOppSet.add(updatedOpp);
                                            }   
                                        }                                        
                                    }
                                    if(fundIds.size() > marketingRepAccMap.get(gw.acc.Id).Opportunities.size())
                                    {
                                        set<id> restOfFunds = new set<Id>();                                        
                                        restOfFunds.addAll(fundIds);
                                        for(Opportunity op: marketingRepAccMap.get(gw.acc.Id).Opportunities)
                                        {
                                            if(op.Fund_Product__c != null)
                                                restOfFunds.remove(op.Fund_Product__c);
                                        }
                                        if(restOfFunds != null && restOfFunds.size()>0)
                                        {
                                            for(Id fund : restOfFunds)
                                            {
                                                Opportunity newOpp = new Opportunity();
                                                String dateVal = opp.Game_Plan_Year__c+'-12-31'; 
                                                newOpp.CloseDate = Date.valueOf(dateVal);
                                                newOpp.AccountId = gw.acc.Id;
                                                newOpp.Fund_Product__c = fund;
                                                newOpp.RecordTypeId = gamePlanOppRecId;
                                                newOpp.Game_Plan_Year__c = opp.Game_Plan_Year__c;
                                                newOpp.OwnerId = acc.Primary_Marketing_Representative__c;
                                                newOpp.Re_up_Potential__c = false;
                                                if(fundNamesList != null && fundNamesList.size() > 0 && fundNamesList.get(newOpp.Fund_Product__c) != null && fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__c != null)
                                                {
                                                    newOpp.Fund_Family__c =  fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__c;
                                                    
                                                    if(string.isNotEmpty(gw.acc.Fund_Families_Invested_In__c))
                                                    {
                                                        list<String> ffiList = gw.acc.Fund_Families_Invested_In__c.split(';');
                                                        for(String ffi : ffiList)
                                                        {
                                                            if(fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__r.Name == ffi)
                                                                newOpp.Re_up_Potential__c = true;
                                                        }
                                                    }                                                    
                                                }
                                                if((gw.opp1 != null && string.isNotEmpty(gw.opp1.StageName)) && (ff1 != null && fund == ff1.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp1.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp1.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff1.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp2 != null && string.isNotEmpty(gw.opp2.StageName)) && (ff2 != null && fund == ff2.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp2.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp2.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff2.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp3 != null && string.isNotEmpty(gw.opp3.StageName)) && (ff3 != null && fund == ff3.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp3.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp3.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff3.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp4 != null && string.isNotEmpty(gw.opp4.StageName)) && (ff4 != null && fund == ff4.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp4.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp4.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff4.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp5 != null && string.isNotEmpty(gw.opp5.StageName)) && (ff5 != null && fund == ff5.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp5.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp5.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff5.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp6 != null && string.isNotEmpty(gw.opp6.StageName)) && (ff6 != null && fund == ff6.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp6.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp6.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff6.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp7 != null && string.isNotEmpty(gw.opp7.StageName)) && (ff7 != null && fund == ff7.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp7.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp7.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff7.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }   
                                                else if((gw.opp8 != null && string.isNotEmpty(gw.opp8.StageName)) && (ff8 != null && fund == ff8.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp8.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp8.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff8.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp9 != null && string.isNotEmpty(gw.opp9.StageName)) && (ff9 != null && fund == ff9.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp9.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp9.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff9.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp10 != null && string.isNotEmpty(gw.opp10.StageName)) && (ff10 != null && fund == ff10.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp10.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp10.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff10.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp11 != null && string.isNotEmpty(gw.opp11.StageName)) && (ff11 != null && fund == ff11.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp11.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp11.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff11.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp12 != null && string.isNotEmpty(gw.opp12.StageName)) && (ff12 != null && fund == ff12.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp12.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp12.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff12.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp13 != null && string.isNotEmpty(gw.opp13.StageName)) && (ff13 != null && fund == ff13.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp13.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp13.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff13.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp14 != null && string.isNotEmpty(gw.opp14.StageName)) && (ff14 != null && fund == ff14.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp14.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp14.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff14.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp15 != null && string.isNotEmpty(gw.opp15.StageName)) && (ff15 != null && fund == ff15.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp15.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp15.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff15.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp16 != null && string.isNotEmpty(gw.opp16.StageName)) && (ff16 != null && fund == ff16.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp16.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp16.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff16.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp17 != null && string.isNotEmpty(gw.opp17.StageName)) && (ff17 != null && fund == ff17.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp17.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp17.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff17.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp18 != null && string.isNotEmpty(gw.opp18.StageName)) && (ff18 != null && fund == ff18.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp18.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp18.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff18.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp19 != null && string.isNotEmpty(gw.opp19.StageName)) && (ff19 != null && fund == ff19.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp19.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp19.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff19.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp20 != null && string.isNotEmpty(gw.opp20.StageName)) && (ff20 != null && fund == ff20.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp20.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp20.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff20.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp21 != null && string.isNotEmpty(gw.opp21.StageName)) && (ff21 != null && fund == ff21.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp21.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp21.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff21.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp22 != null && string.isNotEmpty(gw.opp22.StageName)) && (ff22 != null && fund == ff22.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp22.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp22.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff22.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp23 != null && string.isNotEmpty(gw.opp23.StageName)) && (ff23 != null && fund == ff23.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp23.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp23.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff23.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp24 != null && string.isNotEmpty(gw.opp24.StageName)) && (ff24 != null && fund == ff24.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp24.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp24.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff24.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp25 != null && string.isNotEmpty(gw.opp25.StageName)) && (ff25 != null && fund == ff25.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp25.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp25.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff25.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp26 != null && string.isNotEmpty(gw.opp26.StageName)) && (ff26 != null && fund == ff26.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp26.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp26.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff26.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp27 != null && string.isNotEmpty(gw.opp27.StageName)) && (ff27 != null && fund == ff27.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp27.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp27.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff27.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp28 != null && string.isNotEmpty(gw.opp28.StageName)) && (ff28 != null && fund == ff28.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp28.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp28.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff28.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp29 != null && string.isNotEmpty(gw.opp29.StageName)) && (ff29 != null && fund == ff29.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp29.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp29.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff29.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp30 != null && string.isNotEmpty(gw.opp30.StageName)) && (ff30 != null && fund == ff30.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp30.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp30.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff30.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp31 != null && string.isNotEmpty(gw.opp31.StageName)) && (ff31 != null && fund == ff31.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp31.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp31.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff31.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp32 != null && string.isNotEmpty(gw.opp32.StageName)) && (ff32 != null && fund == ff32.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp32.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp32.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff32.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp33 != null && string.isNotEmpty(gw.opp33.StageName)) && (ff33 != null && fund == ff33.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp33.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp33.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff33.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp34 != null && string.isNotEmpty(gw.opp34.StageName)) && (ff34 != null && fund == ff34.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp34.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp34.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff34.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp35 != null && string.isNotEmpty(gw.opp35.StageName)) && (ff35 != null && fund == ff35.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp35.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp35.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff35.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp36 != null && string.isNotEmpty(gw.opp36.StageName)) && (ff36 != null && fund == ff36.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp36.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp36.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff36.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp37 != null && string.isNotEmpty(gw.opp37.StageName)) && (ff37 != null && fund == ff37.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp37.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp37.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff37.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp38 != null && string.isNotEmpty(gw.opp38.StageName)) && (ff38 != null && fund == ff38.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp38.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp38.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff38.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp39 != null && string.isNotEmpty(gw.opp39.StageName)) && (ff39 != null && fund == ff39.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp39.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp39.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff39.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp40 != null && string.isNotEmpty(gw.opp40.StageName)) && (ff40 != null && fund == ff40.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp40.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp40.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff40.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp41 != null && string.isNotEmpty(gw.opp41.StageName)) && (ff41 != null && fund == ff41.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp41.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp41.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff41.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp42 != null && string.isNotEmpty(gw.opp42.StageName)) && (ff42 != null && fund == ff42.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp42.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp42.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff42.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp43 != null && string.isNotEmpty(gw.opp43.StageName)) && (ff43 != null && fund == ff43.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp43.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp43.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff43.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp44 != null && string.isNotEmpty(gw.opp44.StageName)) && (ff44 != null && fund == ff44.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp44.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp44.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff44.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp45 != null && string.isNotEmpty(gw.opp45.StageName)) && (ff45 != null && fund == ff45.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp45.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp45.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff45.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp46 != null && string.isNotEmpty(gw.opp46.StageName)) && (ff46 != null && fund == ff46.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp46.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp46.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff46.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp47 != null && string.isNotEmpty(gw.opp47.StageName)) && (ff47 != null && fund == ff47.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp47.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp47.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff47.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp48 != null && string.isNotEmpty(gw.opp48.StageName)) && (ff48 != null && fund == ff48.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp48.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp48.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff48.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp49 != null && string.isNotEmpty(gw.opp49.StageName)) && (ff49 != null && fund == ff49.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp49.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp49.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff49.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }
                                                else if((gw.opp50 != null && string.isNotEmpty(gw.opp50.StageName)) && (ff50 != null && fund == ff50.Id))
                                                {
                                                    newOpp.Game_Plan_Amount__c = gw.opp50.Game_Plan_Amount__c;
                                                    newOpp.StageName = gw.opp50.StageName;
                                                    newOpp.Name = gw.acc.Name +' | ' +ff50.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                                    updateOppSet.add(newOpp);
                                                }                                                
                                            }
                                        }       
                                    }
                                }
                                else
                                {
                                    for(Id fund : fundIds)
                                    {
                                        Opportunity newOpp = new Opportunity();
                                        String dateVal = opp.Game_Plan_Year__c+'-12-31'; 
                                        newOpp.CloseDate = Date.valueOf(dateVal);
                                        newOpp.AccountId = gw.acc.Id;
                                        newOpp.Fund_Product__c = fund;
                                        newOpp.RecordTypeId = gamePlanOppRecId;
                                        newOpp.Game_Plan_Year__c = opp.Game_Plan_Year__c;
                                        newOpp.OwnerId = acc.Primary_Marketing_Representative__c;
                                        newOpp.Re_up_Potential__c = false;
                                        if(fundNamesList != null && fundNamesList.size() > 0 && fundNamesList.get(newOpp.Fund_Product__c) != null && fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__c != null)
                                        {
                                            newOpp.Fund_Family__c =  fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__c;
                                            
                                            if(string.isNotEmpty(gw.acc.Fund_Families_Invested_In__c))
                                            {
                                                list<String> ffiList = gw.acc.Fund_Families_Invested_In__c.split(';');
                                                for(String ffi : ffiList)
                                                {
                                                    if(fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__r.Name == ffi)
                                                        newOpp.Re_up_Potential__c = true;
                                                }
                                            }                                                    
                                        }
                                        if((gw.opp1 != null && string.isNotEmpty(gw.opp1.StageName)) && (ff1 != null && fund == ff1.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp1.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp1.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff1.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }  
                                        else if((gw.opp2 != null && string.isNotEmpty(gw.opp2.StageName)) && (ff2 != null && fund == ff2.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp2.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp2.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff2.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp3 != null && string.isNotEmpty(gw.opp3.StageName)) && (ff3 != null && fund == ff3.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp3.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp3.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff3.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp4 != null && string.isNotEmpty(gw.opp4.StageName)) && (ff4 != null && fund == ff4.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp4.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp4.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff4.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp5 != null && string.isNotEmpty(gw.opp5.StageName)) && (ff5 != null && fund == ff5.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp5.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp5.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff5.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp6 != null && string.isNotEmpty(gw.opp6.StageName)) && (ff6 != null && fund == ff6.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp6.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp6.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff6.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp7 != null && string.isNotEmpty(gw.opp7.StageName)) && (ff7 != null && fund == ff7.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp7.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp7.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff7.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }  
                                        else if((gw.opp8 != null && string.isNotEmpty(gw.opp8.StageName)) && (ff8 != null && fund == ff8.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp8.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp8.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff8.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp9 != null && string.isNotEmpty(gw.opp9.StageName)) && (ff9 != null && fund == ff9.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp9.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp9.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff9.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp10 != null && string.isNotEmpty(gw.opp10.StageName)) && (ff10 != null && fund == ff10.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp10.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp10.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff10.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp11 != null && string.isNotEmpty(gw.opp11.StageName)) && (ff11 != null && fund == ff11.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp11.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp11.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff11.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp12 != null && string.isNotEmpty(gw.opp12.StageName)) && (ff12 != null && fund == ff12.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp12.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp12.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff12.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp13 != null && string.isNotEmpty(gw.opp13.StageName)) && (ff13 != null && fund == ff13.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp13.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp13.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff13.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp14 != null && string.isNotEmpty(gw.opp14.StageName)) && (ff14 != null && fund == ff14.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp14.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp14.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff14.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp15 != null && string.isNotEmpty(gw.opp15.StageName)) && (ff15 != null && fund == ff15.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp15.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp15.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff15.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp16 != null && string.isNotEmpty(gw.opp16.StageName)) && (ff16 != null && fund == ff16.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp16.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp16.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff16.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp17 != null && string.isNotEmpty(gw.opp17.StageName)) && (ff17 != null && fund == ff17.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp17.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp17.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff17.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp18 != null && string.isNotEmpty(gw.opp18.StageName)) && (ff18 != null && fund == ff18.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp18.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp18.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff18.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp19 != null && string.isNotEmpty(gw.opp19.StageName)) && (ff19 != null && fund == ff19.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp19.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp19.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff19.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp20 != null && string.isNotEmpty(gw.opp20.StageName)) && (ff20 != null && fund == ff20.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp20.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp20.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff20.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp21 != null && string.isNotEmpty(gw.opp21.StageName)) && (ff21 != null && fund == ff21.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp21.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp21.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff21.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp22 != null && string.isNotEmpty(gw.opp22.StageName)) && (ff22 != null && fund == ff22.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp22.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp22.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff22.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp23 != null && string.isNotEmpty(gw.opp23.StageName)) && (ff23 != null && fund == ff23.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp23.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp23.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff23.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp24 != null && string.isNotEmpty(gw.opp24.StageName)) && (ff24 != null && fund == ff24.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp24.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp24.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff24.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp25 != null && string.isNotEmpty(gw.opp25.StageName)) && (ff25 != null && fund == ff25.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp25.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp25.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff25.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp26 != null && string.isNotEmpty(gw.opp26.StageName)) && (ff26 != null && fund == ff26.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp26.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp26.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff26.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp27 != null && string.isNotEmpty(gw.opp27.StageName)) && (ff27 != null && fund == ff27.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp27.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp27.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff27.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp28 != null && string.isNotEmpty(gw.opp28.StageName)) && (ff28 != null && fund == ff28.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp28.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp28.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff28.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp29 != null && string.isNotEmpty(gw.opp29.StageName)) && (ff29 != null && fund == ff29.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp29.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp29.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff29.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp30 != null && string.isNotEmpty(gw.opp30.StageName)) && (ff30 != null && fund == ff30.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp30.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp30.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff30.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp31 != null && string.isNotEmpty(gw.opp31.StageName)) && (ff31 != null && fund == ff31.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp31.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp31.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff31.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp32 != null && string.isNotEmpty(gw.opp32.StageName)) && (ff32 != null && fund == ff32.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp32.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp32.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff32.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp33 != null && string.isNotEmpty(gw.opp33.StageName)) && (ff33 != null && fund == ff33.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp33.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp33.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff33.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp34 != null && string.isNotEmpty(gw.opp34.StageName)) && (ff34 != null && fund == ff34.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp34.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp34.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff34.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp35 != null && string.isNotEmpty(gw.opp35.StageName)) && (ff35 != null && fund == ff35.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp35.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp35.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff35.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp36 != null && string.isNotEmpty(gw.opp36.StageName)) && (ff36 != null && fund == ff36.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp36.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp36.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff36.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp37 != null && string.isNotEmpty(gw.opp37.StageName)) && (ff37 != null && fund == ff37.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp37.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp37.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff37.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp38 != null && string.isNotEmpty(gw.opp38.StageName)) && (ff38 != null && fund == ff38.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp38.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp38.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff38.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp39 != null && string.isNotEmpty(gw.opp39.StageName)) && (ff39 != null && fund == ff39.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp39.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp39.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff39.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp40 != null && string.isNotEmpty(gw.opp40.StageName)) && (ff40 != null && fund == ff40.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp40.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp40.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff40.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp41 != null && string.isNotEmpty(gw.opp41.StageName)) && (ff41 != null && fund == ff41.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp41.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp41.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff41.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp42 != null && string.isNotEmpty(gw.opp42.StageName)) && (ff42 != null && fund == ff42.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp42.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp42.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff42.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp43 != null && string.isNotEmpty(gw.opp43.StageName)) && (ff43 != null && fund == ff43.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp43.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp43.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff43.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp44 != null && string.isNotEmpty(gw.opp44.StageName)) && (ff44 != null && fund == ff44.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp44.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp44.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff44.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp45 != null && string.isNotEmpty(gw.opp45.StageName)) && (ff45 != null && fund == ff45.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp45.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp45.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff45.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp46 != null && string.isNotEmpty(gw.opp46.StageName)) && (ff46 != null && fund == ff46.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp46.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp46.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff46.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp47 != null && string.isNotEmpty(gw.opp47.StageName)) && (ff47 != null && fund == ff47.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp47.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp47.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff47.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp48 != null && string.isNotEmpty(gw.opp48.StageName)) && (ff48 != null && fund == ff48.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp48.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp48.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff48.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp49 != null && string.isNotEmpty(gw.opp49.StageName)) && (ff49 != null && fund == ff49.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp49.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp49.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff49.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                        else if((gw.opp50 != null && string.isNotEmpty(gw.opp50.StageName)) && (ff50 != null && fund == ff50.Id))
                                        {
                                            newOpp.Game_Plan_Amount__c = gw.opp50.Game_Plan_Amount__c;
                                            newOpp.StageName = gw.opp50.StageName;
                                            newOpp.Name = gw.acc.Name +' | ' +ff50.Fund_Product_Marketing_Name__c+' | '+opp.Game_Plan_Year__c;
                                            updateOppSet.add(newOpp);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    if(updateOppSet != null && updateOppSet.size()>0)
                    {
                        list<Opportunity> deleteOppList = new list<Opportunity>();
                        list<Opportunity> updateOppList = new list<Opportunity>();
                        for(Opportunity opp: updateOppSet){
                            if(opp.Game_Plan_Amount__c == null && String.isEmpty(opp.StageName)){
                                deleteOppList.add(opp);
                            } else {
                                updateOppList.add(opp);
                            }
                        }
                        
                        if(deleteOppList != null && deleteOppList.size() > 0){
                            delete deleteOppList;                  
                        }
                        
                        if(updateOppList != null && updateOppList.size() > 0){
                            upsert updateOppList;
                        }
                    }
                    loadData();                   
                }
                else                
                    return null;
            }
            else
            {
                ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Please acknowledge Game plan year & Marketing Rep details to proceed'));
            }                
            return null;
        }
        catch(Exception e)
        {    
            ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,e.getMessage()));
            Database.rollback(sp);            
            return null;
        }
    }
    private void loadPopupData()
    {       
        assignExistedData();
        map<string, Opportunity> existedOpps = new map<string, Opportunity>();
        list<String> args = new String[]{'0','number','###,###,##0.00'};      
        for(Account ac: marketingRepAccMap.values())
        {
            if(ac.Opportunities != null && ac.Opportunities.size() > 0)
            {
                for(Opportunity op :ac.Opportunities)
                {                   
                    if(op.Fund_Product__c != null)
                    {
                        string key = ac.Id+ '|'+opp.Game_Plan_Year__c+'|'+op.Fund_Product__c;
                        existedOpps.put(key, op);                   
                    }
                }
            }   
        }
        popupResults = new list<orgResultsWrapper>();
        Integer popTotal = 0;        
        for(ocm_FundFamily__c f: fundNamesList.values())
        {           
            string key = popupOrgId+ '|'+opp.Game_Plan_Year__c+'|'+f.Id;
            orgResultsWrapper orw = new orgResultsWrapper();
            orw.orgId = popupOrgId;
            orw.orgName = popupOrgName;
            orw.fundId = f.Id;
            orw.fundName = f.Fund_Product_Marketing_Name__c;            
            if(existedOpps != null && existedOpps.size()>0 && existedOpps.get(key) != null)
            {
                if(existedOpps.get(key).Game_Plan_Amount__c != null)
                {
                    popTotal += Integer.ValueOf(existedOpps.get(key).Game_Plan_Amount__c);
                    orw.fundAmount = string.valueOf(existedOpps.get(key).Game_Plan_Amount__c);
                }   
                if(existedOpps.get(key).StageName != null)
                    orw.fundProbability = existedOpps.get(key).StageName;
            }
            popupResults.add(orw);
        }
        popupOrgTotal = popTotal;
    }
    private Integer popUpTotal()
    {
        Integer popTotal = 0;
        if(popupResults != null && popupResults.size()>0)
        {
            for(orgResultsWrapper orw: popupResults)
            {
                if(string.isNotBlank(orw.fundAmount))
                    popTotal += Integer.ValueOf(orw.fundAmount.replace(',',''));
            }
        }
        return popTotal;
    }    
    public void addRec()
    {      
        assignExistedData();
        map<string, Opportunity> existedOpps = new map<string, Opportunity>();      
        list<String> args = new String[]{'0','number','###,###,##0.00'};
        for(Account ac: marketingRepAccMap.values())
        {
            if(ac.Opportunities != null && ac.Opportunities.size() > 0)
            {
                for(Opportunity op :ac.Opportunities)
                {                   
                    if(op.Fund_Product__c != null)
                    {
                        string key = ac.Id+ '|'+opp.Game_Plan_Year__c+'|'+op.Fund_Product__c;
                        existedOpps.put(key, op);                   
                    }
                }
            }   
        }
        popupResults = new list<orgResultsWrapper>();
        Integer popTotal = 0;        
        for(ocm_FundFamily__c f: fundNamesList.values())
        {           
            string key = popupOrgId+ '|'+opp.Game_Plan_Year__c+'|'+f.Id;
                       
            orgResultsWrapper orw = new orgResultsWrapper();
            orw.orgId = popupOrgId;
            orw.orgName = popupOrgName;
            orw.fundId = f.Id;
            orw.fundName = f.Fund_Product_Marketing_Name__c;
            orw.ffp = f;
            if(existedOpps != null && existedOpps.size()>0 && existedOpps.get(key) != null)
            {
                if(existedOpps.get(key).Game_Plan_Amount__c != null)
                {
                    popTotal += Integer.ValueOf(existedOpps.get(key).Game_Plan_Amount__c);
                    orw.fundAmount = String.format(existedOpps.get(key).Game_Plan_Amount__c.format(), args);
                }   
                if(existedOpps.get(key).StageName != null)
                    orw.fundProbability = existedOpps.get(key).StageName;
            }
            popupResults.add(orw);
        }
        popupOrgTotal = popTotal;
        displayPopup = true;
    }
    
    public PageReference closePopup() 
    {        
        popupOrgId = '';
        popupOrgName = '';
        popupResults = new list<orgResultsWrapper>();
        displayPopup = false;
        return null;
    }
    
    public PageReference saveChildRecs()
    {   
        Savepoint sp = Database.setSavepoint();
        try
        {
            if(popupResults != null)
            {
                assignExistedData();
                map<string, Opportunity> existedOpps = new map<string, Opportunity>();      
                for(Account ac: marketingRepAccMap.values())
                {
                    if(ac.Opportunities != null && ac.Opportunities.size() > 0)
                    {
                        for(Opportunity op :ac.Opportunities)
                        {                   
                            if(op.Fund_Product__c != null)
                            {
                                string key = ac.Id+ '|'+opp.Game_Plan_Year__c+'|'+op.Fund_Product__c;
                                existedOpps.put(key, op);                   
                            }
                        }
                    }   
                }
                set<Opportunity> updatedOpps = new set<Opportunity>();
                for(orgResultsWrapper orpw :popupResults)
                {
                    string key = orpw.orgId+ '|'+opp.Game_Plan_Year__c+'|'+orpw.fundId;
                    if(existedOpps != null && existedOpps.size()>0 && existedOpps.get(key) != null)
                    {
                        Opportunity opprt = new Opportunity(Id = existedOpps.get(key).Id);                        
                        if((String.isBlank(orpw.fundAmount) && String.isNotBlank(orpw.fundProbability)) || (String.isNotBlank(orpw.fundAmount) && String.isBlank(orpw.fundProbability)))
                        {
                            ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+orpw.fundName+' related Amount & Probability to proceed(Enter 0 in Amount if you are not sure)!'));
                            return null;
                        }
                        else if((string.ValueOf(existedOpps.get(key).Game_Plan_Amount__c) != orpw.fundAmount) || (existedOpps.get(key).StageName != orpw.fundProbability))
                        {
                            if(String.isNotBlank(orpw.fundAmount))
                                opprt.Game_Plan_Amount__c = decimal.valueOf(orpw.fundAmount.replace(',',''));
                            else
                                opprt.Game_Plan_Amount__c = null;
                            opprt.StageName = orpw.fundProbability;
                            updatedOpps.add(opprt);
                        }
                    }
                    else
                    {
                        Opportunity newOpp = new Opportunity();
                        String dateVal = opp.Game_Plan_Year__c+'-12-31'; 
                        newOpp.CloseDate = Date.valueOf(dateVal);
                        newOpp.AccountId = orpw.orgId;
                        newOpp.Fund_Product__c = orpw.fundId;
                        newOpp.RecordTypeId = gamePlanOppRecId;
                        newOpp.Game_Plan_Year__c = opp.Game_Plan_Year__c;
                        newOpp.OwnerId = acc.Primary_Marketing_Representative__c;
                        if(fundNamesList != null && fundNamesList.size() > 0 && fundNamesList.get(newOpp.Fund_Product__c) != null && fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__c != null)
                            newOpp.Fund_Family__c =  fundNamesList.get(newOpp.Fund_Product__c).Fund_Family__c;
                        newOpp.Name = orpw.orgName +' | ' +orpw.fundName+' | '+opp.Game_Plan_Year__c;
                        if(String.isNotBlank(orpw.fundAmount) && String.isNotBlank(orpw.fundProbability))
                        {
                            newOpp.Game_Plan_Amount__c = decimal.valueOf(orpw.fundAmount.replace(',',''));
                            newOpp.StageName = orpw.fundProbability;
                            updatedOpps.add(newOpp);
                        }
                        else if((String.isBlank(orpw.fundAmount) && String.isNotBlank(orpw.fundProbability)) || (String.isNotBlank(orpw.fundAmount) && String.isBlank(orpw.fundProbability)))
                        {
                            ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+orpw.fundName+' related Amount & Probability to proceed(Enter 0 in Amount if you are not sure)!'));
                            return null;
                        }   
                        
                    }
                }                
                if(updatedOpps != null && updatedOpps.size()>0)
                {
                    list<Opportunity> deleteOppList = new list<Opportunity>();
                    list<Opportunity> updateOppList = new list<Opportunity>();
                    for(Opportunity opp: updatedOpps)
                    {
                        if((opp.Game_Plan_Amount__c == null || opp.Game_Plan_Amount__c <= 0) && String.isEmpty(opp.StageName)){
                            deleteOppList.add(opp);
                        } else {
                            updateOppList.add(opp);
                        }
                    }
                    
                    if(deleteOppList != null && deleteOppList.size() > 0){
                        delete deleteOppList;                  
                    }
                    
                    if(updateOppList != null && updateOppList.size() > 0){
                        upsert updateOppList;
                    }
                }
            }
            displayPopup = false;
            popupOrgId = '';
            popupOrgName = '';
            popupResults = new list<orgResultsWrapper>();
            loadData();  
            return null;          
        }
        catch(Exception e)
        {    
            ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,e.getMessage()));
            Database.rollback(sp);  
            return null;
        }  
    }
    
    public void sortData() 
    {
        try 
        { 
            isSaveClicked = false;
            if(ApexPages.currentPage().getParameters().get(OCM_Constants.OCM_SORT_BY) != null)
                sortBy = ApexPages.currentPage().getParameters().get(OCM_Constants.OCM_SORT_BY);

            if(filterInputEvent.Subject__c == sortBy) 
                sortAscending = !sortAscending;
            else 
                sortAscending = true;
            
            filterInputEvent.Subject__c = sortBy;

            if(displayPopup == true)
            {
                popupResults.sort();
                if(!sortAscending) 
                {
                    list<orgResultsWrapper> cloneList = popupResults.clone();
                    Integer size = popupResults.size();
                    for(Integer i=0; i < size; i++) {
                        popupResults[i] = cloneList[size-1-i];
                    }
                }
            }
            else
            {
                results.sort();
                if(!sortAscending) 
                {
                    list<GamePlanResultsWrapper> cloneList = results.clone();
                    Integer size = results.size();
                    for(Integer i=0; i < size; i++) {
                        results[i] = cloneList[size-1-i];
                    }
                }
            }
            
        }
        catch (Exception e) {
            ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR, e.getMessage()));
        }
    }
    /*
    private void confirmPaginationsWithSave()
    {
        map<Id, GamePlanResultsWrapper> newResults = new map<Id, GamePlanResultsWrapper>();
        map<Id, GamePlanResultsWrapper> oldResults = new map<Id, GamePlanResultsWrapper>();
        for(GamePlanResultsWrapper gw: results)
            newResults.put(gw.orgId, gw);
            
        for(GamePlanResultsWrapper gw: resultsTemp)
            oldResults.put(gw.orgId, gw);
        
        for(Id grw :newResults.keySet())
        {
            if(newResults.get(grw.orgId).acc.Comments == oldResults.get(grw.orgId).acc.Comments)
                system.debug('==match===');
        }   
    }
    */
    public void Beginning() 
    { 
        counter = 0;
        loadData();
    }
    
    public void Previous() 
    { 
        counter -= list_size;
        loadData();
    }
    
    public void Next() 
    { 
        //confirmPaginationsWithSave();
        counter += list_size;
        loadData();
    }
    
    public void End() 
    { 
        counter = total_size - math.mod(total_size, list_size);
        loadData();
    }
    
    public Boolean getDisablePrevious() 
    { 
        if(counter>0) 
            return false; 
        else 
            return true;
    }

    public Boolean getDisableNext() 
    {
        if(counter + list_size < total_size) 
            return false; 
        else 
            return true;
    }

    public Integer getPageNumber() 
    {
        return counter/list_size + 1;
    }
    
    public Integer getTotalPages() 
    {
        if(math.mod(total_size, list_size) > 0) 
            return total_size/list_size + 1;
        else 
            return (total_size/list_size);
    }
    

    private boolean pageValidations()
    {
        boolean isValid = true;
        set<String> top10NewTargetsSet = new set<String>();
        set<String> top10CrossSellSet = new set<String>();
        set<String> top10ReUpsSet = new set<String>(); 
        if(results != null && results.size() > 0)
        {
            for(GamePlanResultsWrapper gw: results)
            {                
                if(isValid == true && ff1 != null && gw.opp1 != null && ((gw.opp1.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp1.StageName)) || (gw.opp1.Game_Plan_Amount__c != null && String.isEmpty(gw.opp1.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff1.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff2 != null && gw.opp2 != null && ((gw.opp2.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp2.StageName)) || (gw.opp2.Game_Plan_Amount__c != null && String.isEmpty(gw.opp2.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff2.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff3 != null && gw.opp3 != null && ((gw.opp3.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp3.StageName)) || (gw.opp3.Game_Plan_Amount__c != null && String.isEmpty(gw.opp3.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff3.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff4 != null && gw.opp4 != null && ((gw.opp4.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp4.StageName)) || (gw.opp4.Game_Plan_Amount__c != null && String.isEmpty(gw.opp4.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff4.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff5 != null && gw.opp5 != null && ((gw.opp5.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp5.StageName)) || (gw.opp5.Game_Plan_Amount__c != null && String.isEmpty(gw.opp5.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff5.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff6 != null && gw.opp6 != null && ((gw.opp6.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp6.StageName)) || (gw.opp6.Game_Plan_Amount__c != null && String.isEmpty(gw.opp6.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff6.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff7 != null && gw.opp7 != null && ((gw.opp7.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp7.StageName)) || (gw.opp7.Game_Plan_Amount__c != null && String.isEmpty(gw.opp7.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff7.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff8 != null && gw.opp8 != null && ((gw.opp8.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp8.StageName)) || (gw.opp8.Game_Plan_Amount__c != null && String.isEmpty(gw.opp8.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff8.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff9 != null && gw.opp9 != null && ((gw.opp9.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp9.StageName)) || (gw.opp9.Game_Plan_Amount__c != null && String.isEmpty(gw.opp9.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff9.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff10 != null && gw.opp10 != null && ((gw.opp10.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp10.StageName)) || (gw.opp10.Game_Plan_Amount__c != null && String.isEmpty(gw.opp10.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff10.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff11 != null && gw.opp11 != null && ((gw.opp11.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp11.StageName)) || (gw.opp11.Game_Plan_Amount__c != null && String.isEmpty(gw.opp11.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff11.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff12 != null && gw.opp12 != null && ((gw.opp12.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp12.StageName)) || (gw.opp12.Game_Plan_Amount__c != null && String.isEmpty(gw.opp12.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff12.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff13 != null && gw.opp13 != null && ((gw.opp13.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp13.StageName)) || (gw.opp13.Game_Plan_Amount__c != null && String.isEmpty(gw.opp13.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff13.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff14 != null && gw.opp14 != null && ((gw.opp14.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp14.StageName)) || (gw.opp14.Game_Plan_Amount__c != null && String.isEmpty(gw.opp14.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff14.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff15 != null && gw.opp15 != null && ((gw.opp15.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp15.StageName)) || (gw.opp15.Game_Plan_Amount__c != null && String.isEmpty(gw.opp15.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff15.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff16 != null && gw.opp16 != null && ((gw.opp16.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp16.StageName)) || (gw.opp16.Game_Plan_Amount__c != null && String.isEmpty(gw.opp16.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff16.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff17 != null && gw.opp17 != null && ((gw.opp17.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp17.StageName)) || (gw.opp17.Game_Plan_Amount__c != null && String.isEmpty(gw.opp17.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff17.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff18 != null && gw.opp18 != null && ((gw.opp18.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp18.StageName)) || (gw.opp18.Game_Plan_Amount__c != null && String.isEmpty(gw.opp18.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff18.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff19 != null && gw.opp19 != null && ((gw.opp19.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp19.StageName)) || (gw.opp19.Game_Plan_Amount__c != null && String.isEmpty(gw.opp19.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff19.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff20 != null && gw.opp20 != null && ((gw.opp20.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp20.StageName)) || (gw.opp20.Game_Plan_Amount__c != null && String.isEmpty(gw.opp20.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff20.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff21 != null && gw.opp21 != null && ((gw.opp21.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp21.StageName)) || (gw.opp21.Game_Plan_Amount__c != null && String.isEmpty(gw.opp21.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff21.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff22 != null && gw.opp22 != null && ((gw.opp22.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp22.StageName)) || (gw.opp22.Game_Plan_Amount__c != null && String.isEmpty(gw.opp22.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff22.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff23 != null && gw.opp23 != null && ((gw.opp23.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp23.StageName)) || (gw.opp23.Game_Plan_Amount__c != null && String.isEmpty(gw.opp23.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff23.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff24 != null && gw.opp24 != null && ((gw.opp24.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp24.StageName)) || (gw.opp24.Game_Plan_Amount__c != null && String.isEmpty(gw.opp24.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff24.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff25 != null && gw.opp25 != null && ((gw.opp25.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp25.StageName)) || (gw.opp25.Game_Plan_Amount__c != null && String.isEmpty(gw.opp25.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff25.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff26 != null && gw.opp26 != null && ((gw.opp26.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp26.StageName)) || (gw.opp26.Game_Plan_Amount__c != null && String.isEmpty(gw.opp26.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff26.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff27 != null && gw.opp27 != null && ((gw.opp27.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp27.StageName)) || (gw.opp27.Game_Plan_Amount__c != null && String.isEmpty(gw.opp27.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff27.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff28 != null && gw.opp28 != null && ((gw.opp28.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp28.StageName)) || (gw.opp28.Game_Plan_Amount__c != null && String.isEmpty(gw.opp28.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff28.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff29 != null && gw.opp29 != null && ((gw.opp29.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp29.StageName)) || (gw.opp29.Game_Plan_Amount__c != null && String.isEmpty(gw.opp29.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff29.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff30 != null && gw.opp30 != null && ((gw.opp30.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp30.StageName)) || (gw.opp30.Game_Plan_Amount__c != null && String.isEmpty(gw.opp30.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff30.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff31 != null && gw.opp31 != null && ((gw.opp31.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp31.StageName)) || (gw.opp31.Game_Plan_Amount__c != null && String.isEmpty(gw.opp31.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff31.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff32 != null && gw.opp32 != null && ((gw.opp32.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp32.StageName)) || (gw.opp32.Game_Plan_Amount__c != null && String.isEmpty(gw.opp32.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff32.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff33 != null && gw.opp33 != null && ((gw.opp33.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp33.StageName)) || (gw.opp33.Game_Plan_Amount__c != null && String.isEmpty(gw.opp33.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff33.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff34 != null && gw.opp34 != null && ((gw.opp34.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp34.StageName)) || (gw.opp34.Game_Plan_Amount__c != null && String.isEmpty(gw.opp34.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff34.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff35 != null && gw.opp35 != null && ((gw.opp35.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp35.StageName)) || (gw.opp35.Game_Plan_Amount__c != null && String.isEmpty(gw.opp35.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff35.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff36 != null && gw.opp36 != null && ((gw.opp36.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp36.StageName)) || (gw.opp36.Game_Plan_Amount__c != null && String.isEmpty(gw.opp36.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff36.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff37 != null && gw.opp37 != null && ((gw.opp37.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp37.StageName)) || (gw.opp37.Game_Plan_Amount__c != null && String.isEmpty(gw.opp37.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff37.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff38 != null && gw.opp38 != null && ((gw.opp38.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp38.StageName)) || (gw.opp38.Game_Plan_Amount__c != null && String.isEmpty(gw.opp38.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff38.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff39 != null && gw.opp39 != null && ((gw.opp39.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp39.StageName)) || (gw.opp39.Game_Plan_Amount__c != null && String.isEmpty(gw.opp39.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff39.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff40 != null && gw.opp40 != null && ((gw.opp40.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp40.StageName)) || (gw.opp40.Game_Plan_Amount__c != null && String.isEmpty(gw.opp40.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff40.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff41 != null && gw.opp41 != null && ((gw.opp41.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp41.StageName)) || (gw.opp41.Game_Plan_Amount__c != null && String.isEmpty(gw.opp41.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff41.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff42 != null && gw.opp42 != null && ((gw.opp42.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp42.StageName)) || (gw.opp42.Game_Plan_Amount__c != null && String.isEmpty(gw.opp42.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff42.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff43 != null && gw.opp43 != null && ((gw.opp43.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp43.StageName)) || (gw.opp43.Game_Plan_Amount__c != null && String.isEmpty(gw.opp43.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff43.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff44 != null && gw.opp44 != null && ((gw.opp44.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp44.StageName)) || (gw.opp44.Game_Plan_Amount__c != null && String.isEmpty(gw.opp44.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff44.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff45 != null && gw.opp45 != null && ((gw.opp45.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp45.StageName)) || (gw.opp45.Game_Plan_Amount__c != null && String.isEmpty(gw.opp45.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff45.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff46 != null && gw.opp46 != null && ((gw.opp46.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp46.StageName)) || (gw.opp46.Game_Plan_Amount__c != null && String.isEmpty(gw.opp46.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff46.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff47 != null && gw.opp47 != null && ((gw.opp47.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp47.StageName)) || (gw.opp47.Game_Plan_Amount__c != null && String.isEmpty(gw.opp47.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff47.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff48 != null && gw.opp48 != null && ((gw.opp48.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp48.StageName)) || (gw.opp48.Game_Plan_Amount__c != null && String.isEmpty(gw.opp48.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff48.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff49 != null && gw.opp49 != null && ((gw.opp49.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp49.StageName)) || (gw.opp49.Game_Plan_Amount__c != null && String.isEmpty(gw.opp49.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff49.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
                if(isValid == true && ff50 != null && gw.opp50 != null && ((gw.opp50.Game_Plan_Amount__c == null && String.isNotEmpty(gw.opp50.StageName)) || (gw.opp50.Game_Plan_Amount__c != null && String.isEmpty(gw.opp50.StageName))))
                {
                    ApexPages.addMessage(new ApexPages.Message(ApexPages.SEVERITY.ERROR,'Provide '+gw.acc.Name+' related '+ff50.Fund_Product_Marketing_Name__c+' Amount & Probability to proceed (Enter 0 in Amount if you are not sure)!'));
                    isValid = false;
                }
            }
        }
        return isValid;
    }  
    
    public class orgResultsWrapper implements Comparable
    {
         public string orgId {get;set;}
         public string orgName {get;set;}         
         public string fundId {get;set;}
         public string fundName {get;set;}
         public string fundAmount {get;set;}        
         public string fundProbability {get;set;}
         public ocm_FundFamily__c ffp {get;set;}
         public Integer compareTo(Object compareTo) 
         {
            orgResultsWrapper compareToGP = (orgResultsWrapper)compareTo;            
            if(sortBy == 'popFP') 
            {
                if(string.isBlank(fundName) && string.isBlank(compareToGP.fundName))
                    return 0;
                else if(string.isBlank(fundName) && string.isNotBlank(compareToGP.fundName))                
                    return -1;
                else if(string.isNotBlank(fundName) && string.isBlank(compareToGP.fundName))
                    return 1;      
                return fundName.compareTo(compareToGP.fundName);
            } 
            else if(sortBy == 'popFA') 
            {
                if(string.isBlank(fundAmount) && string.isBlank(compareToGP.fundAmount))
                    return 0;
                else if(string.isBlank(fundAmount) && string.isNotBlank(compareToGP.fundAmount))                
                    return -1;
                else if(string.isNotBlank(fundAmount) && string.isBlank(compareToGP.fundAmount))
                    return 1;                    
                else if(Integer.ValueOf(fundAmount) > Integer.ValueOf(compareToGP.fundAmount))
                    return 1;
                else if (Integer.ValueOf(fundAmount) < Integer.ValueOf(compareToGP.fundAmount))
                    return -1;
                else if (Integer.ValueOf(fundAmount) == Integer.ValueOf(compareToGP.fundAmount))
                    return 0; 
            } 
            else if(sortBy == 'popFPr') 
            {
                if(string.isBlank(fundProbability) && string.isBlank(compareToGP.fundProbability))
                    return 0;
                else if(string.isBlank(fundProbability) && string.isNotBlank(compareToGP.fundProbability))                
                    return -1;
                else if(string.isNotBlank(fundProbability) && string.isBlank(compareToGP.fundProbability))
                    return 1;        
                return fundProbability.compareTo(compareToGP.fundProbability);
            }            
            return 0;
        }         
    }
    
    public class GamePlanResultsWrapper implements Comparable
    {
        public Account acc {get; set;}
        public Opportunity opp1 {get;set;}
        public Opportunity opp2 {get;set;}
        public Opportunity opp3 {get;set;}
        public Opportunity opp4 {get;set;}
        public Opportunity opp5 {get;set;}
        public Opportunity opp6 {get;set;}
        public Opportunity opp7 {get;set;}
        public Opportunity opp8 {get;set;}
        public Opportunity opp9 {get;set;}
        public Opportunity opp10 {get;set;}
        public Opportunity opp11 {get;set;}
        public Opportunity opp12 {get;set;}
        public Opportunity opp13 {get;set;}
        public Opportunity opp14 {get;set;}
        public Opportunity opp15 {get;set;}
        public Opportunity opp16 {get;set;}
        public Opportunity opp17 {get;set;}
        public Opportunity opp18 {get;set;}
        public Opportunity opp19 {get;set;}
        public Opportunity opp20 {get;set;}
        public Opportunity opp21 {get;set;}
        public Opportunity opp22 {get;set;}
        public Opportunity opp23 {get;set;}
        public Opportunity opp24 {get;set;}
        public Opportunity opp25 {get;set;}
        public Opportunity opp26 {get;set;}
        public Opportunity opp27 {get;set;}
        public Opportunity opp28 {get;set;}
        public Opportunity opp29 {get;set;}
        public Opportunity opp30 {get;set;}
        public Opportunity opp31 {get;set;}
        public Opportunity opp32 {get;set;}
        public Opportunity opp33 {get;set;}
        public Opportunity opp34 {get;set;}
        public Opportunity opp35 {get;set;}
        public Opportunity opp36 {get;set;}
        public Opportunity opp37 {get;set;}
        public Opportunity opp38 {get;set;}
        public Opportunity opp39 {get;set;}
        public Opportunity opp40 {get;set;}
        public Opportunity opp41 {get;set;}
        public Opportunity opp42 {get;set;}
        public Opportunity opp43 {get;set;}
        public Opportunity opp44 {get;set;}
        public Opportunity opp45 {get;set;}
        public Opportunity opp46 {get;set;}
        public Opportunity opp47 {get;set;}
        public Opportunity opp48 {get;set;}
        public Opportunity opp49 {get;set;}
        public Opportunity opp50 {get;set;}
        
        public Integer compareTo(Object compareTo) 
        {
            GamePlanResultsWrapper compareToGP = (GamePlanResultsWrapper)compareTo;            
            if(sortBy == 'Investor') 
            {
                if(acc.Name == null && compareToGP.acc.Name == null)
                    return 0;
                if(acc.Name == null)
                    return 1;
                if(compareToGP.acc.Name == null)
                    return -1;
                return acc.Name.compareTo(compareToGP.acc.Name);
            } 
            else if(sortBy == 'TOI') 
            {
                if(acc.RecordType.Name == null && compareToGP.acc.RecordType.Name == null)
                    return 0;
                if(acc.RecordType.Name == null)
                    return 1;
                if(compareToGP.acc.RecordType.Name == null)
                    return -1;
                return acc.RecordType.Name.compareTo(compareToGP.acc.RecordType.Name);
            }
            else if(sortBy == 'ActSt') 
            {
                if(acc.Activity_Status__c == null && compareToGP.acc.Activity_Status__c == null)
                    return 0;
                if(acc.Activity_Status__c == null)
                    return 1;
                if(compareToGP.acc.Activity_Status__c == null)
                    return -1;
                return acc.Activity_Status__c.compareTo(compareToGP.acc.Activity_Status__c);
            }            
            else if(sortBy == 'fund1') 
            {
                if(opp1.Game_Plan_Amount__c == null && compareToGP.opp1.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp1.Game_Plan_Amount__c == null && compareToGP.opp1.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp1.Game_Plan_Amount__c != null && compareToGP.opp1.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp1.Game_Plan_Amount__c > compareToGP.opp1.Game_Plan_Amount__c)
                    return 1;
                else if (opp1.Game_Plan_Amount__c < compareToGP.opp1.Game_Plan_Amount__c)
                    return -1;
                else if (opp1.Game_Plan_Amount__c == compareToGP.opp1.Game_Plan_Amount__c)
                    return 0;
            }
            else if(sortBy == 'fund2') 
            {
                if(opp2.Game_Plan_Amount__c == null && compareToGP.opp2.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp2.Game_Plan_Amount__c == null && compareToGP.opp2.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp2.Game_Plan_Amount__c != null && compareToGP.opp2.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp2.Game_Plan_Amount__c > compareToGP.opp2.Game_Plan_Amount__c)
                    return 1;
                else if (opp2.Game_Plan_Amount__c < compareToGP.opp2.Game_Plan_Amount__c)
                    return -1;
                else if (opp2.Game_Plan_Amount__c == compareToGP.opp2.Game_Plan_Amount__c)
                    return 0;
            }
            else if(sortBy == 'fund3') 
            {
                if(opp3.Game_Plan_Amount__c == null && compareToGP.opp3.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp3.Game_Plan_Amount__c == null && compareToGP.opp3.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp3.Game_Plan_Amount__c != null && compareToGP.opp3.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp3.Game_Plan_Amount__c > compareToGP.opp3.Game_Plan_Amount__c)
                    return 1;
                else if (opp3.Game_Plan_Amount__c < compareToGP.opp3.Game_Plan_Amount__c)
                    return -1;
                else if (opp3.Game_Plan_Amount__c == compareToGP.opp3.Game_Plan_Amount__c)
                    return 0;
            }
            else if(sortBy == 'fund4') 
            {
                if(opp4.Game_Plan_Amount__c == null && compareToGP.opp4.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp4.Game_Plan_Amount__c == null && compareToGP.opp4.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp4.Game_Plan_Amount__c != null && compareToGP.opp4.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp4.Game_Plan_Amount__c > compareToGP.opp4.Game_Plan_Amount__c)
                    return 1;
                else if (opp4.Game_Plan_Amount__c < compareToGP.opp4.Game_Plan_Amount__c)
                    return -1;
                else if (opp4.Game_Plan_Amount__c == compareToGP.opp4.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund5') 
            {
                if(opp5.Game_Plan_Amount__c == null && compareToGP.opp5.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp5.Game_Plan_Amount__c == null && compareToGP.opp5.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp5.Game_Plan_Amount__c != null && compareToGP.opp5.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp5.Game_Plan_Amount__c > compareToGP.opp5.Game_Plan_Amount__c)
                    return 1;
                else if (opp5.Game_Plan_Amount__c < compareToGP.opp5.Game_Plan_Amount__c)
                    return -1;
                else if (opp5.Game_Plan_Amount__c == compareToGP.opp5.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund6') 
            {
                if(opp6.Game_Plan_Amount__c == null && compareToGP.opp6.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp6.Game_Plan_Amount__c == null && compareToGP.opp6.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp6.Game_Plan_Amount__c != null && compareToGP.opp6.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp6.Game_Plan_Amount__c > compareToGP.opp6.Game_Plan_Amount__c)
                    return 1;
                else if (opp6.Game_Plan_Amount__c < compareToGP.opp6.Game_Plan_Amount__c)
                    return -1;
                else if (opp6.Game_Plan_Amount__c == compareToGP.opp6.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund7') 
            {
                if(opp7.Game_Plan_Amount__c == null && compareToGP.opp7.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp7.Game_Plan_Amount__c == null && compareToGP.opp7.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp7.Game_Plan_Amount__c != null && compareToGP.opp7.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp7.Game_Plan_Amount__c > compareToGP.opp7.Game_Plan_Amount__c)
                    return 1;
                else if (opp7.Game_Plan_Amount__c < compareToGP.opp7.Game_Plan_Amount__c)
                    return -1;
                else if (opp7.Game_Plan_Amount__c == compareToGP.opp7.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund8') 
            {
                if(opp8.Game_Plan_Amount__c == null && compareToGP.opp8.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp8.Game_Plan_Amount__c == null && compareToGP.opp8.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp8.Game_Plan_Amount__c != null && compareToGP.opp8.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp8.Game_Plan_Amount__c > compareToGP.opp8.Game_Plan_Amount__c)
                    return 1;
                else if (opp8.Game_Plan_Amount__c < compareToGP.opp8.Game_Plan_Amount__c)
                    return -1;
                else if (opp8.Game_Plan_Amount__c == compareToGP.opp8.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund9') 
            {
                if(opp9.Game_Plan_Amount__c == null && compareToGP.opp9.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp9.Game_Plan_Amount__c == null && compareToGP.opp9.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp9.Game_Plan_Amount__c != null && compareToGP.opp9.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp9.Game_Plan_Amount__c > compareToGP.opp9.Game_Plan_Amount__c)
                    return 1;
                else if (opp9.Game_Plan_Amount__c < compareToGP.opp9.Game_Plan_Amount__c)
                    return -1;
                else if (opp9.Game_Plan_Amount__c == compareToGP.opp9.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund10') 
            {
                if(opp10.Game_Plan_Amount__c == null && compareToGP.opp10.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp10.Game_Plan_Amount__c == null && compareToGP.opp10.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp10.Game_Plan_Amount__c != null && compareToGP.opp10.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp10.Game_Plan_Amount__c > compareToGP.opp10.Game_Plan_Amount__c)
                    return 1;
                else if (opp10.Game_Plan_Amount__c < compareToGP.opp10.Game_Plan_Amount__c)
                    return -1;
                else if (opp10.Game_Plan_Amount__c == compareToGP.opp10.Game_Plan_Amount__c)
                    return 0;
            }
            			else if(sortBy == 'fund11') 
            {
                if(opp11.Game_Plan_Amount__c == null && compareToGP.opp11.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp11.Game_Plan_Amount__c == null && compareToGP.opp11.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp11.Game_Plan_Amount__c != null && compareToGP.opp11.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp11.Game_Plan_Amount__c > compareToGP.opp11.Game_Plan_Amount__c)
                    return 1;
                else if (opp11.Game_Plan_Amount__c < compareToGP.opp11.Game_Plan_Amount__c)
                    return -1;
                else if (opp11.Game_Plan_Amount__c == compareToGP.opp11.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund12') 
            {
                if(opp12.Game_Plan_Amount__c == null && compareToGP.opp12.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp12.Game_Plan_Amount__c == null && compareToGP.opp12.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp12.Game_Plan_Amount__c != null && compareToGP.opp12.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp12.Game_Plan_Amount__c > compareToGP.opp12.Game_Plan_Amount__c)
                    return 1;
                else if (opp12.Game_Plan_Amount__c < compareToGP.opp12.Game_Plan_Amount__c)
                    return -1;
                else if (opp12.Game_Plan_Amount__c == compareToGP.opp12.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund13') 
            {
                if(opp13.Game_Plan_Amount__c == null && compareToGP.opp13.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp13.Game_Plan_Amount__c == null && compareToGP.opp13.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp13.Game_Plan_Amount__c != null && compareToGP.opp13.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp13.Game_Plan_Amount__c > compareToGP.opp13.Game_Plan_Amount__c)
                    return 1;
                else if (opp13.Game_Plan_Amount__c < compareToGP.opp13.Game_Plan_Amount__c)
                    return -1;
                else if (opp13.Game_Plan_Amount__c == compareToGP.opp13.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund14') 
            {
                if(opp14.Game_Plan_Amount__c == null && compareToGP.opp14.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp14.Game_Plan_Amount__c == null && compareToGP.opp14.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp14.Game_Plan_Amount__c != null && compareToGP.opp14.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp14.Game_Plan_Amount__c > compareToGP.opp14.Game_Plan_Amount__c)
                    return 1;
                else if (opp14.Game_Plan_Amount__c < compareToGP.opp14.Game_Plan_Amount__c)
                    return -1;
                else if (opp14.Game_Plan_Amount__c == compareToGP.opp14.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund15') 
            {
                if(opp15.Game_Plan_Amount__c == null && compareToGP.opp15.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp15.Game_Plan_Amount__c == null && compareToGP.opp15.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp15.Game_Plan_Amount__c != null && compareToGP.opp15.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp15.Game_Plan_Amount__c > compareToGP.opp15.Game_Plan_Amount__c)
                    return 1;
                else if (opp15.Game_Plan_Amount__c < compareToGP.opp15.Game_Plan_Amount__c)
                    return -1;
                else if (opp15.Game_Plan_Amount__c == compareToGP.opp15.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund16') 
            {
                if(opp16.Game_Plan_Amount__c == null && compareToGP.opp16.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp16.Game_Plan_Amount__c == null && compareToGP.opp16.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp16.Game_Plan_Amount__c != null && compareToGP.opp16.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp16.Game_Plan_Amount__c > compareToGP.opp16.Game_Plan_Amount__c)
                    return 1;
                else if (opp16.Game_Plan_Amount__c < compareToGP.opp16.Game_Plan_Amount__c)
                    return -1;
                else if (opp16.Game_Plan_Amount__c == compareToGP.opp16.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund17') 
            {
                if(opp17.Game_Plan_Amount__c == null && compareToGP.opp17.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp17.Game_Plan_Amount__c == null && compareToGP.opp17.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp17.Game_Plan_Amount__c != null && compareToGP.opp17.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp17.Game_Plan_Amount__c > compareToGP.opp17.Game_Plan_Amount__c)
                    return 1;
                else if (opp17.Game_Plan_Amount__c < compareToGP.opp17.Game_Plan_Amount__c)
                    return -1;
                else if (opp17.Game_Plan_Amount__c == compareToGP.opp17.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund18') 
            {
                if(opp18.Game_Plan_Amount__c == null && compareToGP.opp18.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp18.Game_Plan_Amount__c == null && compareToGP.opp18.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp18.Game_Plan_Amount__c != null && compareToGP.opp18.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp18.Game_Plan_Amount__c > compareToGP.opp18.Game_Plan_Amount__c)
                    return 1;
                else if (opp18.Game_Plan_Amount__c < compareToGP.opp18.Game_Plan_Amount__c)
                    return -1;
                else if (opp18.Game_Plan_Amount__c == compareToGP.opp18.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund19') 
            {
                if(opp19.Game_Plan_Amount__c == null && compareToGP.opp19.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp19.Game_Plan_Amount__c == null && compareToGP.opp19.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp19.Game_Plan_Amount__c != null && compareToGP.opp19.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp19.Game_Plan_Amount__c > compareToGP.opp19.Game_Plan_Amount__c)
                    return 1;
                else if (opp19.Game_Plan_Amount__c < compareToGP.opp19.Game_Plan_Amount__c)
                    return -1;
                else if (opp19.Game_Plan_Amount__c == compareToGP.opp19.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund20') 
            {
                if(opp20.Game_Plan_Amount__c == null && compareToGP.opp20.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp20.Game_Plan_Amount__c == null && compareToGP.opp20.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp20.Game_Plan_Amount__c != null && compareToGP.opp20.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp20.Game_Plan_Amount__c > compareToGP.opp20.Game_Plan_Amount__c)
                    return 1;
                else if (opp20.Game_Plan_Amount__c < compareToGP.opp20.Game_Plan_Amount__c)
                    return -1;
                else if (opp20.Game_Plan_Amount__c == compareToGP.opp20.Game_Plan_Amount__c)
                    return 0;
            }
            else if(sortBy == 'fund21') 
            {
                if(opp21.Game_Plan_Amount__c == null && compareToGP.opp21.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp21.Game_Plan_Amount__c == null && compareToGP.opp21.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp21.Game_Plan_Amount__c != null && compareToGP.opp21.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp21.Game_Plan_Amount__c > compareToGP.opp21.Game_Plan_Amount__c)
                    return 1;
                else if (opp21.Game_Plan_Amount__c < compareToGP.opp21.Game_Plan_Amount__c)
                    return -1;
                else if (opp21.Game_Plan_Amount__c == compareToGP.opp21.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund22') 
            {
                if(opp22.Game_Plan_Amount__c == null && compareToGP.opp22.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp22.Game_Plan_Amount__c == null && compareToGP.opp22.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp22.Game_Plan_Amount__c != null && compareToGP.opp22.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp22.Game_Plan_Amount__c > compareToGP.opp22.Game_Plan_Amount__c)
                    return 1;
                else if (opp22.Game_Plan_Amount__c < compareToGP.opp22.Game_Plan_Amount__c)
                    return -1;
                else if (opp22.Game_Plan_Amount__c == compareToGP.opp22.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund23') 
            {
                if(opp23.Game_Plan_Amount__c == null && compareToGP.opp23.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp23.Game_Plan_Amount__c == null && compareToGP.opp23.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp23.Game_Plan_Amount__c != null && compareToGP.opp23.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp23.Game_Plan_Amount__c > compareToGP.opp23.Game_Plan_Amount__c)
                    return 1;
                else if (opp23.Game_Plan_Amount__c < compareToGP.opp23.Game_Plan_Amount__c)
                    return -1;
                else if (opp23.Game_Plan_Amount__c == compareToGP.opp23.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund24') 
            {
                if(opp24.Game_Plan_Amount__c == null && compareToGP.opp24.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp24.Game_Plan_Amount__c == null && compareToGP.opp24.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp24.Game_Plan_Amount__c != null && compareToGP.opp24.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp24.Game_Plan_Amount__c > compareToGP.opp24.Game_Plan_Amount__c)
                    return 1;
                else if (opp24.Game_Plan_Amount__c < compareToGP.opp24.Game_Plan_Amount__c)
                    return -1;
                else if (opp24.Game_Plan_Amount__c == compareToGP.opp24.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund25') 
            {
                if(opp25.Game_Plan_Amount__c == null && compareToGP.opp25.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp25.Game_Plan_Amount__c == null && compareToGP.opp25.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp25.Game_Plan_Amount__c != null && compareToGP.opp25.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp25.Game_Plan_Amount__c > compareToGP.opp25.Game_Plan_Amount__c)
                    return 1;
                else if (opp25.Game_Plan_Amount__c < compareToGP.opp25.Game_Plan_Amount__c)
                    return -1;
                else if (opp25.Game_Plan_Amount__c == compareToGP.opp25.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund26') 
            {
                if(opp26.Game_Plan_Amount__c == null && compareToGP.opp26.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp26.Game_Plan_Amount__c == null && compareToGP.opp26.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp26.Game_Plan_Amount__c != null && compareToGP.opp26.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp26.Game_Plan_Amount__c > compareToGP.opp26.Game_Plan_Amount__c)
                    return 1;
                else if (opp26.Game_Plan_Amount__c < compareToGP.opp26.Game_Plan_Amount__c)
                    return -1;
                else if (opp26.Game_Plan_Amount__c == compareToGP.opp26.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund27') 
            {
                if(opp27.Game_Plan_Amount__c == null && compareToGP.opp27.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp27.Game_Plan_Amount__c == null && compareToGP.opp27.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp27.Game_Plan_Amount__c != null && compareToGP.opp27.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp27.Game_Plan_Amount__c > compareToGP.opp27.Game_Plan_Amount__c)
                    return 1;
                else if (opp27.Game_Plan_Amount__c < compareToGP.opp27.Game_Plan_Amount__c)
                    return -1;
                else if (opp27.Game_Plan_Amount__c == compareToGP.opp27.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund28') 
            {
                if(opp28.Game_Plan_Amount__c == null && compareToGP.opp28.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp28.Game_Plan_Amount__c == null && compareToGP.opp28.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp28.Game_Plan_Amount__c != null && compareToGP.opp28.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp28.Game_Plan_Amount__c > compareToGP.opp28.Game_Plan_Amount__c)
                    return 1;
                else if (opp28.Game_Plan_Amount__c < compareToGP.opp28.Game_Plan_Amount__c)
                    return -1;
                else if (opp28.Game_Plan_Amount__c == compareToGP.opp28.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund29') 
            {
                if(opp29.Game_Plan_Amount__c == null && compareToGP.opp29.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp29.Game_Plan_Amount__c == null && compareToGP.opp29.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp29.Game_Plan_Amount__c != null && compareToGP.opp29.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp29.Game_Plan_Amount__c > compareToGP.opp29.Game_Plan_Amount__c)
                    return 1;
                else if (opp29.Game_Plan_Amount__c < compareToGP.opp29.Game_Plan_Amount__c)
                    return -1;
                else if (opp29.Game_Plan_Amount__c == compareToGP.opp29.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund30') 
            {
                if(opp30.Game_Plan_Amount__c == null && compareToGP.opp30.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp30.Game_Plan_Amount__c == null && compareToGP.opp30.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp30.Game_Plan_Amount__c != null && compareToGP.opp30.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp30.Game_Plan_Amount__c > compareToGP.opp30.Game_Plan_Amount__c)
                    return 1;
                else if (opp30.Game_Plan_Amount__c < compareToGP.opp30.Game_Plan_Amount__c)
                    return -1;
                else if (opp30.Game_Plan_Amount__c == compareToGP.opp30.Game_Plan_Amount__c)
                    return 0;
            }
            else if(sortBy == 'fund31') 
            {
                if(opp31.Game_Plan_Amount__c == null && compareToGP.opp31.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp31.Game_Plan_Amount__c == null && compareToGP.opp31.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp31.Game_Plan_Amount__c != null && compareToGP.opp31.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp31.Game_Plan_Amount__c > compareToGP.opp31.Game_Plan_Amount__c)
                    return 1;
                else if (opp31.Game_Plan_Amount__c < compareToGP.opp31.Game_Plan_Amount__c)
                    return -1;
                else if (opp31.Game_Plan_Amount__c == compareToGP.opp31.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund32') 
            {
                if(opp32.Game_Plan_Amount__c == null && compareToGP.opp32.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp32.Game_Plan_Amount__c == null && compareToGP.opp32.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp32.Game_Plan_Amount__c != null && compareToGP.opp32.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp32.Game_Plan_Amount__c > compareToGP.opp32.Game_Plan_Amount__c)
                    return 1;
                else if (opp32.Game_Plan_Amount__c < compareToGP.opp32.Game_Plan_Amount__c)
                    return -1;
                else if (opp32.Game_Plan_Amount__c == compareToGP.opp32.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund33') 
            {
                if(opp33.Game_Plan_Amount__c == null && compareToGP.opp33.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp33.Game_Plan_Amount__c == null && compareToGP.opp33.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp33.Game_Plan_Amount__c != null && compareToGP.opp33.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp33.Game_Plan_Amount__c > compareToGP.opp33.Game_Plan_Amount__c)
                    return 1;
                else if (opp33.Game_Plan_Amount__c < compareToGP.opp33.Game_Plan_Amount__c)
                    return -1;
                else if (opp33.Game_Plan_Amount__c == compareToGP.opp33.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund34') 
            {
                if(opp34.Game_Plan_Amount__c == null && compareToGP.opp34.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp34.Game_Plan_Amount__c == null && compareToGP.opp34.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp34.Game_Plan_Amount__c != null && compareToGP.opp34.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp34.Game_Plan_Amount__c > compareToGP.opp34.Game_Plan_Amount__c)
                    return 1;
                else if (opp34.Game_Plan_Amount__c < compareToGP.opp34.Game_Plan_Amount__c)
                    return -1;
                else if (opp34.Game_Plan_Amount__c == compareToGP.opp34.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund35') 
            {
                if(opp35.Game_Plan_Amount__c == null && compareToGP.opp35.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp35.Game_Plan_Amount__c == null && compareToGP.opp35.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp35.Game_Plan_Amount__c != null && compareToGP.opp35.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp35.Game_Plan_Amount__c > compareToGP.opp35.Game_Plan_Amount__c)
                    return 1;
                else if (opp35.Game_Plan_Amount__c < compareToGP.opp35.Game_Plan_Amount__c)
                    return -1;
                else if (opp35.Game_Plan_Amount__c == compareToGP.opp35.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund36') 
            {
                if(opp36.Game_Plan_Amount__c == null && compareToGP.opp36.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp36.Game_Plan_Amount__c == null && compareToGP.opp36.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp36.Game_Plan_Amount__c != null && compareToGP.opp36.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp36.Game_Plan_Amount__c > compareToGP.opp36.Game_Plan_Amount__c)
                    return 1;
                else if (opp36.Game_Plan_Amount__c < compareToGP.opp36.Game_Plan_Amount__c)
                    return -1;
                else if (opp36.Game_Plan_Amount__c == compareToGP.opp36.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund37') 
            {
                if(opp37.Game_Plan_Amount__c == null && compareToGP.opp37.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp37.Game_Plan_Amount__c == null && compareToGP.opp37.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp37.Game_Plan_Amount__c != null && compareToGP.opp37.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp37.Game_Plan_Amount__c > compareToGP.opp37.Game_Plan_Amount__c)
                    return 1;
                else if (opp37.Game_Plan_Amount__c < compareToGP.opp37.Game_Plan_Amount__c)
                    return -1;
                else if (opp37.Game_Plan_Amount__c == compareToGP.opp37.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund38') 
            {
                if(opp38.Game_Plan_Amount__c == null && compareToGP.opp38.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp38.Game_Plan_Amount__c == null && compareToGP.opp38.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp38.Game_Plan_Amount__c != null && compareToGP.opp38.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp38.Game_Plan_Amount__c > compareToGP.opp38.Game_Plan_Amount__c)
                    return 1;
                else if (opp38.Game_Plan_Amount__c < compareToGP.opp38.Game_Plan_Amount__c)
                    return -1;
                else if (opp38.Game_Plan_Amount__c == compareToGP.opp38.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund39') 
            {
                if(opp39.Game_Plan_Amount__c == null && compareToGP.opp39.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp39.Game_Plan_Amount__c == null && compareToGP.opp39.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp39.Game_Plan_Amount__c != null && compareToGP.opp39.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp39.Game_Plan_Amount__c > compareToGP.opp39.Game_Plan_Amount__c)
                    return 1;
                else if (opp39.Game_Plan_Amount__c < compareToGP.opp39.Game_Plan_Amount__c)
                    return -1;
                else if (opp39.Game_Plan_Amount__c == compareToGP.opp39.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund40') 
            {
                if(opp40.Game_Plan_Amount__c == null && compareToGP.opp40.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp40.Game_Plan_Amount__c == null && compareToGP.opp40.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp40.Game_Plan_Amount__c != null && compareToGP.opp40.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp40.Game_Plan_Amount__c > compareToGP.opp40.Game_Plan_Amount__c)
                    return 1;
                else if (opp40.Game_Plan_Amount__c < compareToGP.opp40.Game_Plan_Amount__c)
                    return -1;
                else if (opp40.Game_Plan_Amount__c == compareToGP.opp40.Game_Plan_Amount__c)
                    return 0;
            }
            else if(sortBy == 'fund41') 
            {
                if(opp41.Game_Plan_Amount__c == null && compareToGP.opp41.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp41.Game_Plan_Amount__c == null && compareToGP.opp41.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp41.Game_Plan_Amount__c != null && compareToGP.opp41.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp41.Game_Plan_Amount__c > compareToGP.opp41.Game_Plan_Amount__c)
                    return 1;
                else if (opp41.Game_Plan_Amount__c < compareToGP.opp41.Game_Plan_Amount__c)
                    return -1;
                else if (opp41.Game_Plan_Amount__c == compareToGP.opp41.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund42') 
            {
                if(opp42.Game_Plan_Amount__c == null && compareToGP.opp42.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp42.Game_Plan_Amount__c == null && compareToGP.opp42.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp42.Game_Plan_Amount__c != null && compareToGP.opp42.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp42.Game_Plan_Amount__c > compareToGP.opp42.Game_Plan_Amount__c)
                    return 1;
                else if (opp42.Game_Plan_Amount__c < compareToGP.opp42.Game_Plan_Amount__c)
                    return -1;
                else if (opp42.Game_Plan_Amount__c == compareToGP.opp42.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund43') 
            {
                if(opp43.Game_Plan_Amount__c == null && compareToGP.opp43.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp43.Game_Plan_Amount__c == null && compareToGP.opp43.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp43.Game_Plan_Amount__c != null && compareToGP.opp43.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp43.Game_Plan_Amount__c > compareToGP.opp43.Game_Plan_Amount__c)
                    return 1;
                else if (opp43.Game_Plan_Amount__c < compareToGP.opp43.Game_Plan_Amount__c)
                    return -1;
                else if (opp43.Game_Plan_Amount__c == compareToGP.opp43.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund44') 
            {
                if(opp44.Game_Plan_Amount__c == null && compareToGP.opp44.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp44.Game_Plan_Amount__c == null && compareToGP.opp44.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp44.Game_Plan_Amount__c != null && compareToGP.opp44.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp44.Game_Plan_Amount__c > compareToGP.opp44.Game_Plan_Amount__c)
                    return 1;
                else if (opp44.Game_Plan_Amount__c < compareToGP.opp44.Game_Plan_Amount__c)
                    return -1;
                else if (opp44.Game_Plan_Amount__c == compareToGP.opp44.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund45') 
            {
                if(opp45.Game_Plan_Amount__c == null && compareToGP.opp45.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp45.Game_Plan_Amount__c == null && compareToGP.opp45.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp45.Game_Plan_Amount__c != null && compareToGP.opp45.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp45.Game_Plan_Amount__c > compareToGP.opp45.Game_Plan_Amount__c)
                    return 1;
                else if (opp45.Game_Plan_Amount__c < compareToGP.opp45.Game_Plan_Amount__c)
                    return -1;
                else if (opp45.Game_Plan_Amount__c == compareToGP.opp45.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund46') 
            {
                if(opp46.Game_Plan_Amount__c == null && compareToGP.opp46.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp46.Game_Plan_Amount__c == null && compareToGP.opp46.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp46.Game_Plan_Amount__c != null && compareToGP.opp46.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp46.Game_Plan_Amount__c > compareToGP.opp46.Game_Plan_Amount__c)
                    return 1;
                else if (opp46.Game_Plan_Amount__c < compareToGP.opp46.Game_Plan_Amount__c)
                    return -1;
                else if (opp46.Game_Plan_Amount__c == compareToGP.opp46.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund47') 
            {
                if(opp47.Game_Plan_Amount__c == null && compareToGP.opp47.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp47.Game_Plan_Amount__c == null && compareToGP.opp47.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp47.Game_Plan_Amount__c != null && compareToGP.opp47.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp47.Game_Plan_Amount__c > compareToGP.opp47.Game_Plan_Amount__c)
                    return 1;
                else if (opp47.Game_Plan_Amount__c < compareToGP.opp47.Game_Plan_Amount__c)
                    return -1;
                else if (opp47.Game_Plan_Amount__c == compareToGP.opp47.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund48') 
            {
                if(opp48.Game_Plan_Amount__c == null && compareToGP.opp48.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp48.Game_Plan_Amount__c == null && compareToGP.opp48.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp48.Game_Plan_Amount__c != null && compareToGP.opp48.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp48.Game_Plan_Amount__c > compareToGP.opp48.Game_Plan_Amount__c)
                    return 1;
                else if (opp48.Game_Plan_Amount__c < compareToGP.opp48.Game_Plan_Amount__c)
                    return -1;
                else if (opp48.Game_Plan_Amount__c == compareToGP.opp48.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund49') 
            {
                if(opp49.Game_Plan_Amount__c == null && compareToGP.opp49.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp49.Game_Plan_Amount__c == null && compareToGP.opp49.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp49.Game_Plan_Amount__c != null && compareToGP.opp49.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp49.Game_Plan_Amount__c > compareToGP.opp49.Game_Plan_Amount__c)
                    return 1;
                else if (opp49.Game_Plan_Amount__c < compareToGP.opp49.Game_Plan_Amount__c)
                    return -1;
                else if (opp49.Game_Plan_Amount__c == compareToGP.opp49.Game_Plan_Amount__c)
                    return 0;
            }
			else if(sortBy == 'fund50') 
            {
                if(opp50.Game_Plan_Amount__c == null && compareToGP.opp50.Game_Plan_Amount__c == null)
                    return 0;
                else if(opp50.Game_Plan_Amount__c == null && compareToGP.opp50.Game_Plan_Amount__c != null)                
                    return -1;
                else if(opp50.Game_Plan_Amount__c != null && compareToGP.opp50.Game_Plan_Amount__c == null)
                    return 1;
                else if(opp50.Game_Plan_Amount__c > compareToGP.opp50.Game_Plan_Amount__c)
                    return 1;
                else if (opp50.Game_Plan_Amount__c < compareToGP.opp50.Game_Plan_Amount__c)
                    return -1;
                else if (opp50.Game_Plan_Amount__c == compareToGP.opp50.Game_Plan_Amount__c)
                    return 0;
            }                
            return 0;
        } 
    }
}